{"ast":null,"code":"// src/utils/AccessibilityManager.js - Fixed version\nclass AccessibilityManager {\n  constructor() {\n    this.isAccessibilityMode = false;\n    this.speechSynthesis = window.speechSynthesis;\n    this.currentUtterance = null;\n    this.voice = null;\n    this.isReading = false;\n    this.readingQueue = [];\n    this.shortcuts = new Map();\n    this.focusedElement = null;\n    this.navigationMode = 'normal';\n    this.currentFocusIndex = 0;\n    this.focusableElements = [];\n    this.navigationHistory = [];\n    this.readingSpeed = 1.0;\n\n    // Mod de editare\n    this.isEditMode = false;\n    this.currentEditElement = null;\n    this.lastTypedChar = '';\n    this.typingTimer = null;\n\n    // Pentru alegerea editorului\n    this.waitingForEditorChoice = false;\n    this.currentEditorElement = null;\n\n    // Setări pentru citire live\n    this.liveReadingEnabled = true;\n    this.readFullWords = true;\n    this.charEchoEnabled = true;\n\n    // Flag special pentru Monaco Editor\n    this.isInMonacoEditor = false;\n    this.monacoActive = false;\n    this.initializeVoice();\n    this.setupGlobalListeners();\n    this.registerShortcuts();\n  }\n  initializeVoice() {\n    const setVoice = () => {\n      const voices = this.speechSynthesis.getVoices();\n\n      // Lista de voci românești preferate (în ordinea preferinței)\n      const romanianVoiceNames = ['Microsoft Andrei - Romanian (Romania)', 'Microsoft Ioana - Romanian (Romania)', 'Google română', 'Romanian Romania', 'Romanian Female', 'Romanian Male'];\n\n      // Căutăm mai întâi după nume specific\n      let selectedVoice = null;\n      for (const voiceName of romanianVoiceNames) {\n        selectedVoice = voices.find(voice => voice.name.toLowerCase().includes(voiceName.toLowerCase()));\n        if (selectedVoice) break;\n      }\n\n      // Dacă nu găsim după nume, căutăm după cod de limbă\n      if (!selectedVoice) {\n        selectedVoice = voices.find(voice => voice.lang === 'ro-RO') || voices.find(voice => voice.lang.startsWith('ro')) || voices.find(voice => voice.lang.includes('ro'));\n      }\n\n      // Fallback la prima voce disponibilă\n      this.voice = selectedVoice || voices[0];\n\n      // Afișăm informații despre vocea selectată\n      if (this.voice) {\n        console.log(`Voce selectată: ${this.voice.name} (${this.voice.lang})`);\n\n        // Anunțăm utilizatorul despre vocea selectată\n        if (this.voice.lang.startsWith('ro')) {\n          console.log('✓ Voce românească activată cu succes!');\n        } else {\n          console.warn('⚠ Nu s-a găsit o voce românească. Folosesc:', this.voice.name);\n          console.log('Sugestie: Instalați o voce românească în sistemul de operare.');\n        }\n      }\n\n      // Listăm toate vocile disponibile pentru debugging\n      console.log('Voci disponibile:');\n      voices.forEach(voice => {\n        if (voice.lang.includes('ro')) {\n          console.log(`  ✓ ${voice.name} - ${voice.lang} (Română)`);\n        }\n      });\n    };\n\n    // Încercăm să setăm vocea imediat\n    if (this.speechSynthesis.getVoices().length > 0) {\n      setVoice();\n    } else {\n      // Așteptăm ca vocile să se încarce\n      this.speechSynthesis.addEventListener('voiceschanged', setVoice);\n    }\n\n    // Forțăm o reîncărcare după 100ms pentru siguranță\n    setTimeout(() => {\n      if (!this.voice || !this.voice.lang.includes('ro')) {\n        setVoice();\n      }\n    }, 100);\n  }\n  setupGlobalListeners() {\n    // Expunem managerul la nivel global pentru verificări\n    window.accessibilityManager = this;\n\n    // Detectăm când intrăm/ieșim din Monaco prin multiple metode\n    document.addEventListener('focusin', e => {\n      const inMonaco = this.isMonacoRelated(e.target);\n      if (inMonaco && !this.monacoActive) {\n        this.monacoActive = true;\n        this.isInMonacoEditor = true;\n        console.log('📝 Monaco Editor ACTIVATED - ALL accessibility disabled');\n      }\n    }, true);\n    document.addEventListener('focusout', e => {\n      // Verificăm după un mic delay dacă am ieșit complet din Monaco\n      setTimeout(() => {\n        const activeElement = document.activeElement;\n        if (!this.isMonacoRelated(activeElement) && this.monacoActive) {\n          this.monacoActive = false;\n          this.isInMonacoEditor = false;\n          console.log('📝 Monaco Editor DEACTIVATED - Accessibility re-enabled');\n        }\n      }, 50);\n    }, true);\n\n    // Click detection pentru Monaco\n    document.addEventListener('click', e => {\n      if (this.isAccessibilityMode) {\n        const clickedMonaco = this.isMonacoRelated(e.target);\n        if (clickedMonaco !== this.monacoActive) {\n          this.monacoActive = clickedMonaco;\n          this.isInMonacoEditor = clickedMonaco;\n          console.log(`📝 Monaco state changed via click: ${clickedMonaco}`);\n        }\n      }\n    }, true);\n\n    // CRITICAL: Keydown handler cu verificare strictă pentru Monaco\n    document.addEventListener('keydown', e => {\n      // Dacă Monaco este activ, procesăm DOAR Escape și Ctrl+Shift+A\n      if (this.monacoActive && this.isAccessibilityMode) {\n        if (e.key === 'Escape') {\n          e.preventDefault();\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n          this.exitMonacoEditor();\n          return false;\n        }\n        // Permitem Ctrl+Shift+A pentru a dezactiva modul accesibilitate complet\n        if (e.ctrlKey && e.shiftKey && e.key === 'A') {\n          e.preventDefault();\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n          this.toggleAccessibilityMode();\n          return false;\n        }\n        // BLOCARE TOTALĂ pentru orice altă tastă\n        return;\n      }\n\n      // Ctrl + Shift + A pentru activarea modului (în afara Monaco)\n      if (e.ctrlKey && e.shiftKey && e.key === 'A') {\n        e.preventDefault();\n        e.stopPropagation();\n        this.toggleAccessibilityMode();\n        return;\n      }\n      if (!this.isAccessibilityMode) {\n        return;\n      }\n\n      // În modul editare pentru alte elemente (non-Monaco)\n      if (this.isEditMode && !this.monacoActive) {\n        this.handleEditModeKeydown(e);\n        return;\n      }\n\n      // Prevenim comportamentul default doar pentru taste speciale în modul navigare\n      if (!this.isEditMode && ['Tab', 'Enter', ' ', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      this.handleAccessibilityShortcuts(e);\n    }, true); // Capture phase pentru prioritate maximă\n\n    // Blocăm și keyup în Monaco pentru siguranță\n    document.addEventListener('keyup', e => {\n      if (this.monacoActive && this.isAccessibilityMode) {\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n      }\n    }, true);\n\n    // Blocăm și keypress în Monaco\n    document.addEventListener('keypress', e => {\n      if (this.monacoActive && this.isAccessibilityMode) {\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n      }\n    }, true);\n\n    // Handler pentru input events\n    document.addEventListener('input', e => {\n      // Dacă suntem în Monaco, nu procesăm deloc\n      if (this.monacoActive || this.isInMonacoEditor) {\n        return;\n      }\n      if (this.isAccessibilityMode && this.isEditMode && this.liveReadingEnabled) {\n        this.handleLiveReading(e);\n      }\n    }, true);\n\n    // Actualizăm lista de elemente focusabile când se schimbă DOM-ul\n    const observer = new MutationObserver(() => {\n      if (this.isAccessibilityMode && !this.isEditMode && !this.monacoActive) {\n        this.updateFocusableElements();\n      }\n    });\n    observer.observe(document.body, {\n      childList: true,\n      subtree: true\n    });\n  }\n\n  // Metodă îmbunătățită pentru detectarea Monaco\n  isMonacoRelated(element) {\n    if (!element || !element.nodeType) return false;\n\n    // Listă extinsă de indicatori Monaco\n    const monacoIndicators = [\n    // Clase Monaco\n    '.monaco-editor', '.overflow-guard', '.inputarea', '.view-line', '.view-lines', '.lines-content', '.monaco-editor-background', '.monaco-scrollable-element', '.cursor', '.cursors-layer', '.minimap', '.decorationsOverviewRuler', '.editor-container', '.editor-widget',\n    // ID-uri și atribute\n    '#code-editor', '[data-uri*=\"monaco\"]', '[data-mode-id]',\n    // Containere custom\n    '.code-editor', '.editor-wrapper', '.code-editor-container', '.monaco-container'];\n\n    // Verificăm elementul și toți părinții\n    let currentElement = element;\n    let depth = 0;\n    const maxDepth = 15; // Limităm adâncimea pentru performanță\n\n    while (currentElement && depth < maxDepth) {\n      // Verificare clase directe\n      if (currentElement.classList) {\n        for (const indicator of monacoIndicators) {\n          if (indicator.startsWith('.') && currentElement.classList.contains(indicator.slice(1))) {\n            return true;\n          }\n        }\n      }\n\n      // Verificare ID\n      if (currentElement.id === 'code-editor') {\n        return true;\n      }\n\n      // Verificare atribute\n      if (currentElement.getAttribute) {\n        var _currentElement$getAt;\n        if ((_currentElement$getAt = currentElement.getAttribute('data-uri')) !== null && _currentElement$getAt !== void 0 && _currentElement$getAt.includes('monaco') || currentElement.getAttribute('data-mode-id') || currentElement.getAttribute('role') === 'code' || currentElement.getAttribute('data-monaco-editor') === 'true') {\n          return true;\n        }\n      }\n\n      // Verificare querySelector pentru toate indicatoarele\n      for (const indicator of monacoIndicators) {\n        if (currentElement.matches && currentElement.matches(indicator)) {\n          return true;\n        }\n      }\n      currentElement = currentElement.parentElement;\n      depth++;\n    }\n    return false;\n  }\n  registerShortcuts() {\n    // Comenzi de navigare principală\n    this.shortcuts.set('Tab', () => this.navigateNext());\n    this.shortcuts.set('Shift+Tab', () => this.navigatePrevious());\n    this.shortcuts.set('Enter', () => this.activateElement());\n    this.shortcuts.set(' ', () => this.toggleReading());\n    this.shortcuts.set('Escape', () => this.stopReading());\n\n    // Navigare rapidă cu F-keys - MODIFICAT pentru F2 și F3\n    this.shortcuts.set('F1', () => this.readHelp());\n    this.shortcuts.set('F2', () => this.navigateToLogin()); // NOU - pentru login\n    this.shortcuts.set('F3', () => this.navigateToRegister()); // NOU - pentru register\n    // F4 eliminat complet\n\n    // Navigare în pagini\n    this.shortcuts.set('alt+c', () => this.navigateToCourses());\n    this.shortcuts.set('alt+p', () => this.navigateToPlayground());\n    this.shortcuts.set('alt+r', () => this.navigateToProfile());\n    this.shortcuts.set('alt+h', () => this.goHome());\n\n    // Comenzi utilitare\n    this.shortcuts.set('alt+m', () => this.readCurrentPage());\n    this.shortcuts.set('alt+n', () => this.readNavigationInfo());\n    this.shortcuts.set('alt+s', () => this.adjustSpeed());\n    this.shortcuts.set('alt+b', () => this.navigateBack()); // FIXAT - înapoi la pagina anterioară\n    this.shortcuts.set('alt+l', () => this.listAllElements());\n\n    // Navigare prin elemente similare\n    this.shortcuts.set('ctrl+b', () => this.nextButton());\n    this.shortcuts.set('ctrl+l', () => this.nextLink());\n    this.shortcuts.set('ctrl+i', () => this.nextInput());\n    this.shortcuts.set('ctrl+t', () => this.nextHeading());\n\n    // Navigare în quiz\n    this.shortcuts.set('alt+1', () => this.selectQuizOption(0));\n    this.shortcuts.set('alt+2', () => this.selectQuizOption(1));\n    this.shortcuts.set('alt+3', () => this.selectQuizOption(2));\n    this.shortcuts.set('alt+4', () => this.selectQuizOption(3));\n\n    // Comenzi pentru editor de cod\n    this.shortcuts.set('alt+e', () => this.executeCode());\n    this.shortcuts.set('alt+f', () => this.getFeedback());\n\n    // Comenzi pentru modul editare\n    this.shortcuts.set('alt+q', () => this.readCurrentLine());\n    this.shortcuts.set('alt+w', () => this.readCurrentWord());\n    this.shortcuts.set('alt+d', () => this.toggleLiveReading());\n  }\n\n  // METODĂ NOUĂ pentru F2 - login\n  navigateToLogin() {\n    this.navigationHistory.push(window.location.href);\n    this.speak(\"Navighez la autentificare\", 'high');\n    window.location.href = '/login';\n  }\n\n  // METODĂ NOUĂ pentru F3 - register\n  navigateToRegister() {\n    this.navigationHistory.push(window.location.href);\n    this.speak(\"Navighez la înregistrare\", 'high');\n    window.location.href = '/register';\n  }\n  // METODĂ NOUĂ: F4 pentru ajutor specific paginii\n  readPageSpecificHelp() {\n    const currentPage = this.getPageName(window.location.pathname);\n    let helpText = `Ajutor pentru ${currentPage}:\\n\\n`;\n    switch (currentPage) {\n      case 'pagina principală':\n        helpText += `\n          Navigare:\n          - Tab pentru a naviga prin elemente\n          - Enter pentru a activa linkurile și butoanele\n          - Alt + C pentru a merge direct la cursuri\n          \n          Caracteristici disponibile:\n          - Cursuri Java interactive\n          - Playground pentru experimentare cu cod\n          - Sistem de progres și realizări\n        `;\n        break;\n      case 'pagina de cursuri':\n        helpText += `\n          Navigare prin cursuri:\n          - Săgeata sus/jos pentru a naviga prin cursuri\n          - Enter pentru a selecta un curs\n          - Escape pentru a opri citirea\n          \n          Informații utile:\n          - Fiecare curs conține multiple lecții\n          - Progresul se salvează automat\n          - La sfârșit vei susține un test\n        `;\n        break;\n      case 'playground-ul de cod':\n        helpText += `\n          Comenzi pentru playground:\n          - Săgeata sus/jos pentru navigare prin exemple\n          - Enter pentru a activa/dezactiva editorul de cod\n          - Alt + E pentru execuția codului (când editorul este activ)\n          - Alt + F pentru feedback AI\n          - Escape pentru a ieși din editorul de cod\n          \n          Funcționalități:\n          - Editare de cod în timp real\n          - Execuție instant a codului Java\n          - Feedback inteligent de la AI\n          - Exemple predefinite pentru învățare\n        `;\n        break;\n      case 'pagina de profil':\n        helpText += `\n          Navigare în profil:\n          - Tab pentru navigare prin secțiuni\n          - Enter pentru a accesa diferitele tab-uri\n          - Butonul Continuă pentru a relua cursurile\n          \n          Secțiuni disponibile:\n          - Cursurile Mele: vezi progresul cursurilor\n          - Realizări: vezi badge-urile câștigate\n          - Setări: personalizează contul\n        `;\n        break;\n      case 'pagina de test':\n        helpText += `\n          Comenzi pentru test:\n          - Tastele 1-4 pentru selectarea răspunsurilor\n          - Enter pentru validarea răspunsului\n          - Escape pentru a opri citirea\n          \n          La sfârșitul testului:\n          - R pentru a relua testul\n          - Alt + R pentru a merge la profil\n          - Alt + C pentru a reveni la cursuri\n          \n          Sfaturi:\n          - Ascultă întrebarea complet înainte de a răspunde\n          - Poți schimba răspunsul înainte de validare\n        `;\n        break;\n      case 'pagina de autentificare':\n      case 'pagina de înregistrare':\n        helpText += `\n          Completarea formularului:\n          - Tab pentru navigare între câmpuri\n          - Enter pentru a intra în modul editare\n          - Escape pentru a ieși din modul editare\n          - Enter pe buton pentru trimiterea formularului\n          \n          Notă:\n          - Pentru câmpurile de parolă, caracterele nu se citesc pentru securitate\n          - Toate câmpurile marcate sunt obligatorii\n        `;\n        break;\n      default:\n        helpText += `\n          Comenzi generale:\n          - Tab și Shift + Tab pentru navigare\n          - Enter pentru activarea elementelor\n          - F1 pentru ajutorul complet\n          - Alt + B pentru înapoi\n          \n          Navigare rapidă:\n          - Alt + C pentru cursuri\n          - Alt + P pentru playground\n          - Alt + R pentru profil\n          - Alt + H pentru acasă\n        `;\n        break;\n    }\n    this.speak(helpText, 'high');\n  }\n  handleEditModeKeydown(e) {\n    // Această funcție este apelată doar pentru non-Monaco editors\n    if (e.key === 'Escape') {\n      e.preventDefault();\n      this.exitEditMode();\n      return;\n    }\n    if (e.altKey && e.key === 'q') {\n      e.preventDefault();\n      this.readCurrentLine();\n      return;\n    }\n    if (e.altKey && e.key === 'w') {\n      e.preventDefault();\n      this.readCurrentWord();\n      return;\n    }\n    if (e.altKey && e.key === 'd') {\n      e.preventDefault();\n      this.toggleLiveReading();\n      return;\n    }\n\n    // Pentru input-uri normale - citire la navigare stânga/dreapta\n    if (['ArrowLeft', 'ArrowRight'].includes(e.key)) {\n      setTimeout(() => {\n        this.readCharacterAtCursor();\n      }, 50);\n    }\n  }\n  handleLiveReading(e) {\n    const target = e.target;\n\n    // Pentru Monaco Editor, nu procesăm\n    if (this.isMonacoRelated(target)) {\n      return;\n    }\n    if (!['INPUT', 'TEXTAREA'].includes(target.tagName)) {\n      return;\n    }\n\n    // Anulăm timer-ul anterior\n    if (this.typingTimer) {\n      clearTimeout(this.typingTimer);\n    }\n\n    // FIXAT: Pentru câmpurile de parolă, nu citim caracterele\n    const inputType = target.type;\n    if (inputType === 'password') {\n      // Pentru parolă, nu citim caracterele individual\n      return;\n    }\n\n    // Citim caracterul tastat imediat - ÎMBUNĂTĂȚIT pentru punctuație\n    if (this.charEchoEnabled && e.data) {\n      this.speak(this.getCharDescription(e.data), 'high');\n    }\n\n    // Setăm un timer pentru a citi cuvântul complet\n    if (this.readFullWords) {\n      this.typingTimer = setTimeout(() => {\n        const word = this.getCurrentWord(target);\n        if (word && word.length > 1) {\n          this.speak(`Cuvânt: ${word}`, 'normal');\n        }\n      }, 500);\n    }\n  }\n\n  // ÎMBUNĂTĂȚIRE: Descrierea caracterelor cu semne de punctuație\n  getCharDescription(char) {\n    const charDescriptions = {\n      ' ': 'spațiu',\n      '.': 'punct',\n      ',': 'virgulă',\n      ';': 'punct și virgulă',\n      ':': 'două puncte',\n      '!': 'semnul exclamării',\n      '?': 'semnul întrebării',\n      '\"': 'ghilimele',\n      \"'\": 'apostrof',\n      '(': 'paranteză deschisă',\n      ')': 'paranteză închisă',\n      '[': 'paranteză pătrată deschisă',\n      ']': 'paranteză pătrată închisă',\n      '{': 'acoladă deschisă',\n      '}': 'acoladă închisă',\n      '<': 'mai mic',\n      '>': 'mai mare',\n      '=': 'egal',\n      '+': 'plus',\n      '-': 'minus',\n      '*': 'asterisc',\n      '/': 'slash',\n      '\\\\': 'backslash',\n      '@': 'arobase',\n      '#': 'diez',\n      '$': 'dolar',\n      '%': 'procent',\n      '^': 'circumflex',\n      '&': 'ampersand',\n      '_': 'underscore',\n      '|': 'bară verticală',\n      '~': 'tildă',\n      '`': 'accent grav',\n      '\\n': 'linie nouă',\n      '\\t': 'tab'\n    };\n    return charDescriptions[char] || char;\n  }\n  getCurrentWord(element) {\n    const value = element.value || element.textContent;\n    const cursorPos = element.selectionStart || value.length;\n    let start = cursorPos;\n    let end = cursorPos;\n    while (start > 0 && !/\\s/.test(value[start - 1])) {\n      start--;\n    }\n    while (end < value.length && !/\\s/.test(value[end])) {\n      end++;\n    }\n    return value.substring(start, end).trim();\n  }\n  readCurrentLine() {\n    if (!this.currentEditElement) {\n      this.speak(\"Nu ești într-un câmp de editare\", 'high');\n      return;\n    }\n\n    // Pentru Monaco Editor - versiune simplificată\n    if (this.isMonacoRelated(this.currentEditElement)) {\n      this.speak(\"Citirea liniei în Monaco Editor nu este disponibilă momentan\", 'high');\n      return;\n    }\n    const element = this.currentEditElement;\n    if (element.tagName === 'TEXTAREA') {\n      const value = element.value || '';\n      const cursorPos = element.selectionStart || 0;\n      const lines = value.split('\\n');\n      let currentLineIndex = 0;\n      let charCount = 0;\n      for (let i = 0; i < lines.length; i++) {\n        charCount += lines[i].length + 1;\n        if (charCount > cursorPos) {\n          currentLineIndex = i;\n          break;\n        }\n      }\n      const currentLine = lines[currentLineIndex];\n      if (currentLine.trim()) {\n        this.speak(`Linia ${currentLineIndex + 1}: ${currentLine}`, 'high');\n      } else {\n        this.speak(`Linia ${currentLineIndex + 1}: linie goală`, 'high');\n      }\n    } else {\n      const value = element.value;\n      if (value) {\n        this.speak(`Conținut: ${value}`, 'high');\n      } else {\n        this.speak(\"Câmp gol\", 'high');\n      }\n    }\n  }\n  readCurrentWord() {\n    if (!this.currentEditElement) {\n      this.speak(\"Nu ești într-un câmp de editare\", 'high');\n      return;\n    }\n\n    // Pentru Monaco Editor - versiune simplificată\n    if (this.isMonacoRelated(this.currentEditElement)) {\n      this.speak(\"Citirea cuvântului în Monaco Editor nu este disponibilă momentan\", 'high');\n      return;\n    }\n    const word = this.getCurrentWord(this.currentEditElement);\n    if (word) {\n      this.speak(`Cuvânt: ${word}`, 'high');\n    } else {\n      this.speak(\"Nu există cuvânt la poziția curentă\", 'high');\n    }\n  }\n  readCharacterAtCursor() {\n    if (!this.currentEditElement) return;\n    const element = this.currentEditElement;\n    const value = element.value;\n    const cursorPos = element.selectionStart;\n    if (cursorPos < value.length) {\n      const char = value[cursorPos];\n      this.speak(this.getCharDescription(char), 'high');\n    } else {\n      this.speak(\"Sfârșit de text\", 'high');\n    }\n  }\n  toggleLiveReading() {\n    this.liveReadingEnabled = !this.liveReadingEnabled;\n    this.speak(this.liveReadingEnabled ? \"Citire live activată\" : \"Citire live dezactivată\", 'high');\n  }\n  activateElement() {\n    if (!this.focusedElement) {\n      this.speak(\"Niciun element selectat\", 'high');\n      return;\n    }\n    const tagName = this.focusedElement.tagName.toLowerCase();\n\n    // Pentru Monaco Editor - activare specială\n    if (this.isMonacoRelated(this.focusedElement)) {\n      this.enterMonacoEditor(this.focusedElement);\n      return;\n    }\n\n    // Pentru inputuri normale\n    if (['input', 'textarea', 'select'].includes(tagName)) {\n      this.enterEditMode(this.focusedElement);\n      return;\n    }\n\n    // Pentru alte elemente\n    this.speak(\"Activez elementul\", 'normal');\n    if (this.focusedElement.click) {\n      this.focusedElement.click();\n    } else if (tagName === 'a') {\n      window.location.href = this.focusedElement.href;\n    }\n  }\n  enterMonacoEditor(element) {\n    // Setăm flagurile înainte de orice altceva\n    this.monacoActive = true;\n    this.isInMonacoEditor = true;\n    this.isEditMode = true;\n    this.currentEditElement = element;\n\n    // Găsim containerul Monaco\n    const monacoContainer = element.classList.contains('monaco-editor') ? element : element.closest('.monaco-editor') || element.closest('.editor-wrapper') || element;\n\n    // Focusăm editorul Monaco\n    setTimeout(() => {\n      // Căutăm diferite elemente care pot primi focus în Monaco\n      const focusTargets = ['.inputarea', '.monaco-editor textarea', '[role=\"textbox\"]', '.view-lines', '.monaco-editor'];\n      let focused = false;\n      for (const selector of focusTargets) {\n        const target = monacoContainer.querySelector(selector);\n        if (target) {\n          target.focus();\n          target.click();\n          focused = true;\n          console.log('✅ Focused Monaco element:', selector);\n          break;\n        }\n      }\n      if (!focused) {\n        monacoContainer.click();\n        console.log('⚠️ Clicked container as fallback');\n      }\n    }, 100);\n    this.speak(\"Editor de cod activat. Scrie normal. Apasă Escape pentru a ieși.\", 'high');\n    document.body.classList.add('editing-monaco');\n    document.dispatchEvent(new CustomEvent('monacoEditModeChanged', {\n      detail: {\n        isActive: true\n      }\n    }));\n    console.log('🟢 Monaco Editor fully activated');\n  }\n  exitMonacoEditor() {\n    console.log('🔴 Exiting Monaco Editor...');\n    this.monacoActive = false;\n    this.isInMonacoEditor = false;\n    this.isEditMode = false;\n\n    // Blur toate elementele Monaco posibile\n    const monacoElements = document.querySelectorAll('.monaco-editor textarea, .inputarea, [role=\"textbox\"]');\n    monacoElements.forEach(el => el.blur());\n\n    // Blur și elementul activ curent\n    if (document.activeElement) {\n      document.activeElement.blur();\n    }\n    document.body.classList.remove('editing-monaco');\n    this.speak(\"Am ieșit din editorul de cod. Navigare reactivată.\", 'high');\n\n    // Re-focusăm containerul pentru navigare\n    if (this.currentEditElement) {\n      const container = this.currentEditElement.closest('.monaco-editor') || this.currentEditElement.closest('.editor-wrapper') || this.currentEditElement;\n      setTimeout(() => {\n        this.setFocus(container);\n      }, 100);\n      this.currentEditElement = null;\n    }\n    document.dispatchEvent(new CustomEvent('monacoEditModeChanged', {\n      detail: {\n        isActive: false\n      }\n    }));\n    console.log('✅ Monaco Editor deactivated');\n  }\n  enterEditMode(element) {\n    // Pentru input-uri normale (non-Monaco)\n    this.isEditMode = true;\n    this.currentEditElement = element;\n    element.focus();\n    element.classList.add('accessibility-edit-mode');\n\n    // FIXAT: Pentru câmpurile de parolă, nu citim caracterele\n    const inputType = element.type;\n    let announcement = 'Mod editare activat. ';\n    if (inputType === 'password') {\n      announcement += 'Câmp parolă. Caracterele nu vor fi citite pentru securitate. ';\n    } else {\n      announcement += this.getEditModeInstructions(element);\n    }\n    this.speak(announcement, 'high');\n    document.body.classList.add('editing');\n    document.dispatchEvent(new CustomEvent('editModeChanged', {\n      detail: {\n        isEditMode: true,\n        element: element\n      }\n    }));\n  }\n  exitEditMode() {\n    if (!this.isEditMode) return;\n    this.isEditMode = false;\n    if (this.currentEditElement) {\n      this.currentEditElement.blur();\n      this.currentEditElement.classList.remove('accessibility-edit-mode');\n      document.body.classList.remove('editing');\n      this.speak(\"Mod editare dezactivat. Navigare reactivată\", 'high');\n\n      // Re-focusăm elementul pentru navigare\n      this.setFocus(this.currentEditElement);\n      this.currentEditElement = null;\n    }\n    document.dispatchEvent(new CustomEvent('editModeChanged', {\n      detail: {\n        isEditMode: false\n      }\n    }));\n  }\n  getEditModeInstructions(element) {\n    const tagName = element.tagName.toLowerCase();\n    let instructions = \"\";\n    switch (tagName) {\n      case 'input':\n        const inputType = element.type;\n        if (inputType === 'text' || inputType === 'email') {\n          instructions = \"Tastează textul dorit. \";\n        } else if (inputType === 'password') {\n          instructions = \"Tastează parola. Caracterele nu vor fi citite pentru securitate. \";\n        }\n        break;\n      case 'textarea':\n        instructions = \"Tastează textul. Folosește Enter pentru linie nouă. \";\n        break;\n      case 'select':\n        instructions = \"Folosește săgețile sus/jos pentru a selecta o opțiune. \";\n        break;\n      default:\n        instructions = \"Element în modul editare. \";\n        break;\n    }\n    if (element.type !== 'password') {\n      instructions += \"Alt+Q pentru a citi linia curentă. \";\n      instructions += \"Alt+W pentru a citi cuvântul curent. \";\n    }\n    instructions += \"Escape pentru a ieși din modul editare.\";\n    return instructions;\n  }\n  toggleAccessibilityMode() {\n    this.isAccessibilityMode = !this.isAccessibilityMode;\n    if (this.isAccessibilityMode) {\n      // ÎMBUNĂTĂȚIRE: Anunț clar la activare\n      this.speak(\"Modul pentru nevăzători a fost activat cu succes! Bine ai venit în JavaVerse!\", 'high');\n      this.addAccessibilityStyles();\n      this.updateFocusableElements();\n      setTimeout(() => {\n        this.readWelcomeMessage();\n      }, 2000);\n    } else {\n      this.speak(\"Modul pentru nevăzători dezactivat.\");\n      this.removeAccessibilityStyles();\n      this.stopReading();\n      if (this.isEditMode) {\n        this.exitEditMode();\n      }\n      if (this.isInMonacoEditor || this.monacoActive) {\n        this.exitMonacoEditor();\n      }\n    }\n    document.dispatchEvent(new CustomEvent('accessibilityModeChanged', {\n      detail: {\n        isActive: this.isAccessibilityMode\n      }\n    }));\n  }\n  readWelcomeMessage() {\n    const welcomeText = `\n      Bine ai venit în modul pentru nevăzători JavaVerse!\n      \n      Navigare principală:\n      - Tab pentru următorul element\n      - Shift + Tab pentru elementul anterior\n      - Enter pentru a activa elementul selectat\n      - Spațiu pentru pauză sau continuare citire\n      - Escape pentru a opri citirea\n      \n      Navigare rapidă:\n      - F1 pentru meniul de ajutor\n      - F2 pentru autentificare\n      - F3 pentru înregistrare\n      \n      Navigare în site cu Alt:\n      - Alt + C pentru cursuri\n      - Alt + P pentru playground\n      - Alt + R pentru profil\n      - Alt + H pentru pagina principală\n      - Alt + B pentru înapoi la pagina anterioară\n      \n      Navigare prin elemente cu Ctrl:\n      - Ctrl + B pentru următorul buton\n      - Ctrl + L pentru următorul link\n      - Ctrl + I pentru următorul câmp de input\n      - Ctrl + T pentru următorul titlu\n      \n      În editorul de cod:\n      - Enter pentru a intra în editor\n      - Scrie normal ca în orice editor\n      - Escape pentru a ieși din editor și a reveni la navigare\n      \n      Alte comenzi utile:\n      - Alt + M pentru citirea paginii curente\n      - Alt + N pentru informații de navigare\n      - Alt + S pentru ajustarea vitezei de citire\n      - Alt + L pentru lista tuturor elementelor\n      \n      În quiz folosește Alt + 1, 2, 3 sau 4 pentru variante.\n      În editor folosește Alt + E pentru execuție și Alt + F pentru feedback.\n    `;\n    this.speak(welcomeText, 'high');\n  }\n  handleAccessibilityShortcuts(e) {\n    if (this.isEditMode || this.isInMonacoEditor || this.monacoActive) return;\n    const key = this.getShortcutKey(e);\n    const handler = this.shortcuts.get(key);\n    if (handler) {\n      e.preventDefault();\n      handler();\n    }\n  }\n  getShortcutKey(e) {\n    const parts = [];\n    if (e.ctrlKey) parts.push('ctrl');\n    if (e.altKey) parts.push('alt');\n    if (e.shiftKey) parts.push('Shift');\n    let key = e.key;\n    if (key === ' ') key = ' ';\n    if (key.length === 1) key = key.toLowerCase();\n    parts.push(key);\n    return parts.join('+');\n  }\n\n  // ÎMBUNĂTĂȚIRE: updateFocusableElements pentru a exclude elemente redundante\n  updateFocusableElements() {\n    const selectors = ['a[href]:not([disabled]):not(.footer-link)',\n    // Excludem linkurile din footer\n    'button:not([disabled])', 'input:not([disabled]):not([type=\"hidden\"])', 'select:not([disabled])', 'textarea:not([disabled])', '[tabindex]:not([tabindex=\"-1\"])', '.course-card', '.question-container li', '.feature-card', '.example-card', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', '[role=\"button\"]:not([disabled])', '[role=\"link\"]', '[role=\"navigation\"]', '[role=\"main\"]', '.monaco-editor', '.editor-wrapper', '#code-editor', '.tabButton',\n    // Pentru tab-urile din profil\n    '.statCard',\n    // Pentru cardurile de statistici\n    '.continueButton',\n    // Pentru butonul continua din cursuri\n    '.achievementCard' // Pentru cardurile de realizări\n    ];\n    this.focusableElements = Array.from(document.querySelectorAll(selectors.join(', '))).filter(el => {\n      const rect = el.getBoundingClientRect();\n      // Excludem elementele care nu sunt vizibile\n      if (rect.width === 0 || rect.height === 0 || el.offsetParent === null) {\n        return false;\n      }\n\n      // Excludem elementele din footer\n      if (el.closest('.jv-footer')) {\n        return false;\n      }\n\n      // FIXAT: Excludem chenarul alb de pe pagina cu cursuri\n      if (el.classList.contains('accessibility-navigation-info')) {\n        return false;\n      }\n\n      // Pentru pagina de profil - optimizare navigare\n      if (window.location.pathname === '/profile') {\n        var _document$querySelect;\n        // Dacă suntem pe tab-ul cursuri, includem doar elementele relevante\n        const activeTab = (_document$querySelect = document.querySelector('.activeTab')) === null || _document$querySelect === void 0 ? void 0 : _document$querySelect.textContent;\n        if (activeTab === 'Cursurile Mele') {\n          // Includem doar cardurile de cursuri și butoanele lor\n          if (el.classList.contains('tabButton') || el.closest('.courseCard') || el.classList.contains('continueButton')) {\n            return true;\n          }\n          return false;\n        }\n        // Similar pentru alte tab-uri\n        if (activeTab === 'Realizări') {\n          if (el.classList.contains('tabButton') || el.closest('.achievementsContainer') || el.classList.contains('checkAchievementsBtn')) {\n            return true;\n          }\n          return false;\n        }\n        if (activeTab === 'Setări') {\n          if (el.classList.contains('tabButton') || el.closest('.settingsContainer')) {\n            return true;\n          }\n          return false;\n        }\n      }\n      return true;\n    }).sort((a, b) => {\n      const rectA = a.getBoundingClientRect();\n      const rectB = b.getBoundingClientRect();\n      if (Math.abs(rectA.top - rectB.top) < 10) {\n        return rectA.left - rectB.left;\n      }\n      return rectA.top - rectB.top;\n    });\n  }\n  navigateNext() {\n    this.updateFocusableElements();\n    if (this.focusableElements.length === 0) {\n      this.speak(\"Nu sunt elemente disponibile pentru navigare\", 'high');\n      return;\n    }\n    this.currentFocusIndex = (this.currentFocusIndex + 1) % this.focusableElements.length;\n    this.setFocus(this.focusableElements[this.currentFocusIndex]);\n  }\n  navigatePrevious() {\n    this.updateFocusableElements();\n    if (this.focusableElements.length === 0) {\n      this.speak(\"Nu sunt elemente disponibile pentru navigare\", 'high');\n      return;\n    }\n    this.currentFocusIndex = this.currentFocusIndex === 0 ? this.focusableElements.length - 1 : this.currentFocusIndex - 1;\n    this.setFocus(this.focusableElements[this.currentFocusIndex]);\n  }\n  setFocus(element) {\n    if (!element) return;\n    document.querySelectorAll('.accessibility-focus').forEach(el => {\n      el.classList.remove('accessibility-focus');\n    });\n    this.focusedElement = element;\n    element.classList.add('accessibility-focus');\n    element.scrollIntoView({\n      behavior: 'smooth',\n      block: 'center',\n      inline: 'nearest'\n    });\n    if (['INPUT', 'TEXTAREA', 'SELECT'].includes(element.tagName) && !this.isEditMode) {\n      // Nu dăm focus automat\n    }\n    this.readElementInfo(element);\n  }\n\n  // ÎMBUNĂTĂȚIRE: readElementInfo pentru a evita citirea redundantă\n  readElementInfo(element) {\n    var _element$textContent, _document$querySelect2, _document$querySelect3, _element$options$elem, _document$querySelect4;\n    let description = '';\n    const tagName = element.tagName.toLowerCase();\n    const ariaLabel = element.getAttribute('aria-label');\n    const text = (_element$textContent = element.textContent) === null || _element$textContent === void 0 ? void 0 : _element$textContent.trim();\n\n    // Verificăm mai întâi dacă e Monaco Editor\n    if (this.isMonacoRelated(element)) {\n      const codeContent = this.getMonacoContent(element);\n      if (codeContent) {\n        description = `Editor de cod. ${codeContent.split('\\n').length} linii de cod. Apasă Enter pentru a edita.`;\n      } else {\n        description = 'Editor de cod gol. Apasă Enter pentru a începe să scrii cod.';\n      }\n      this.speak(description, 'high');\n      return;\n    }\n    if (ariaLabel) {\n      description = ariaLabel;\n    } else {\n      switch (tagName) {\n        case 'button':\n          // Pentru butonul \"Continuă\" din profil\n          if (element.classList.contains('continueButton')) {\n            description = `Buton Continuă cursul`;\n          } else {\n            description = `Buton: ${text || 'Fără text'}`;\n          }\n          break;\n        case 'a':\n          description = `Link: ${text || 'Fără text'}`;\n          break;\n        case 'input':\n          const inputType = element.type;\n          const inputLabel = (_document$querySelect2 = document.querySelector(`label[for=\"${element.id}\"]`)) === null || _document$querySelect2 === void 0 ? void 0 : _document$querySelect2.textContent;\n          const inputValue = element.value;\n          if (inputType === 'text' || inputType === 'email' || inputType === 'password') {\n            description = `Câmp ${inputType}: ${inputLabel || element.placeholder || 'Fără etichetă'}`;\n            if (inputValue && inputType !== 'password') {\n              description += `. Valoare curentă: ${inputValue}`;\n            } else if (inputValue && inputType === 'password') {\n              description += `. Parolă introdusă`;\n            }\n          } else if (inputType === 'radio' || inputType === 'checkbox') {\n            description = `${inputType === 'radio' ? 'Opțiune' : 'Bifă'}: ${inputLabel || text}. ${element.checked ? 'Selectat' : 'Neselectat'}`;\n          }\n          break;\n        case 'select':\n          const selectLabel = (_document$querySelect3 = document.querySelector(`label[for=\"${element.id}\"]`)) === null || _document$querySelect3 === void 0 ? void 0 : _document$querySelect3.textContent;\n          const selectedOption = (_element$options$elem = element.options[element.selectedIndex]) === null || _element$options$elem === void 0 ? void 0 : _element$options$elem.text;\n          description = `Listă derulantă: ${selectLabel || 'Fără etichetă'}. Selectat: ${selectedOption || 'Nimic'}`;\n          break;\n        case 'textarea':\n          const textareaLabel = (_document$querySelect4 = document.querySelector(`label[for=\"${element.id}\"]`)) === null || _document$querySelect4 === void 0 ? void 0 : _document$querySelect4.textContent;\n          description = `Zonă de text: ${textareaLabel || element.placeholder || 'Fără etichetă'}`;\n          if (element.value) {\n            description += `. ${element.value.length} caractere introduse`;\n          }\n          break;\n        case 'h1':\n        case 'h2':\n        case 'h3':\n        case 'h4':\n        case 'h5':\n        case 'h6':\n          // ÎMBUNĂTĂȚIRE: Nu citim titlurile ca elemente separate dacă fac parte dintr-un card\n          if (element.closest('.course-card') || element.closest('.statCard') || element.closest('.achievementCard') || element.closest('.settingSection')) {\n            return; // Nu citim titlurile din interiorul cardurilor\n          }\n          const level = tagName.charAt(1);\n          description = `Titlu nivel ${level}: ${text}`;\n          break;\n        default:\n          if (element.classList.contains('course-card')) {\n            var _element$querySelecto, _element$querySelecto2;\n            const title = (_element$querySelecto = element.querySelector('.course-title, h2, h3')) === null || _element$querySelecto === void 0 ? void 0 : _element$querySelecto.textContent;\n            const desc = (_element$querySelecto2 = element.querySelector('.course-description, p')) === null || _element$querySelecto2 === void 0 ? void 0 : _element$querySelecto2.textContent;\n            description = `Curs: ${title}. ${desc || ''}`;\n          } else if (element.classList.contains('statCard')) {\n            var _element$querySelecto3, _element$querySelecto4;\n            const value = (_element$querySelecto3 = element.querySelector('.statValue')) === null || _element$querySelecto3 === void 0 ? void 0 : _element$querySelecto3.textContent;\n            const label = (_element$querySelecto4 = element.querySelector('.statLabel')) === null || _element$querySelecto4 === void 0 ? void 0 : _element$querySelecto4.textContent;\n            description = `Statistică: ${value} ${label}`;\n          } else if (element.classList.contains('feature-card')) {\n            var _element$querySelecto5, _element$querySelecto6;\n            const title = (_element$querySelecto5 = element.querySelector('h3')) === null || _element$querySelecto5 === void 0 ? void 0 : _element$querySelecto5.textContent;\n            const desc = (_element$querySelecto6 = element.querySelector('p')) === null || _element$querySelecto6 === void 0 ? void 0 : _element$querySelecto6.textContent;\n            description = `Caracteristică: ${title}. ${desc}`;\n          } else if (element.classList.contains('example-card')) {\n            var _element$querySelecto7;\n            const title = ((_element$querySelecto7 = element.querySelector('.card-title')) === null || _element$querySelecto7 === void 0 ? void 0 : _element$querySelecto7.textContent) || text;\n            description = `Exemplu de cod: ${title}`;\n          } else if (element.classList.contains('tabButton')) {\n            description = `Tab: ${text}`;\n          } else if (element.classList.contains('achievementCard')) {\n            var _element$querySelecto8, _element$querySelecto9;\n            const name = (_element$querySelecto8 = element.querySelector('h3')) === null || _element$querySelecto8 === void 0 ? void 0 : _element$querySelecto8.textContent;\n            const desc = (_element$querySelecto9 = element.querySelector('p')) === null || _element$querySelecto9 === void 0 ? void 0 : _element$querySelecto9.textContent;\n            const isUnlocked = !element.classList.contains('lockedAchievement');\n            description = `Realizare ${isUnlocked ? 'deblocată' : 'blocată'}: ${name}. ${desc}`;\n          } else {\n            description = text || `Element ${tagName}`;\n          }\n          break;\n      }\n    }\n    if (['button', 'a'].includes(tagName) || element.getAttribute('role') === 'button') {\n      description += \". Apasă Enter pentru a activa\";\n    } else if (['input', 'textarea', 'select'].includes(tagName)) {\n      description += \". Apasă Enter pentru a edita\";\n    }\n    this.speak(description, 'high');\n  }\n  navigateToSection(sectionName) {\n    let selector;\n    let announcement;\n    switch (sectionName) {\n      case 'header':\n        selector = 'header, [role=\"banner\"], .jv-header';\n        announcement = \"Navighez la header\";\n        break;\n      case 'main':\n        selector = 'main, [role=\"main\"], .body-content';\n        announcement = \"Navighez la conținutul principal\";\n        break;\n      default:\n        this.speak(\"Secțiune necunoscută\", 'high');\n        return;\n    }\n    const section = document.querySelector(selector);\n    if (section) {\n      this.speak(announcement, 'high');\n      const firstFocusable = section.querySelector('a, button, input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n      if (firstFocusable) {\n        const index = this.focusableElements.indexOf(firstFocusable);\n        if (index !== -1) {\n          this.currentFocusIndex = index;\n          this.setFocus(firstFocusable);\n        }\n      } else {\n        section.scrollIntoView({\n          behavior: 'smooth',\n          block: 'start'\n        });\n        this.speak(\"Secțiune fără elemente interactive\", 'normal');\n      }\n    } else {\n      this.speak(\"Secțiunea nu a fost găsită\", 'high');\n    }\n  }\n  nextButton() {\n    this.navigateToNextOfType('button, [role=\"button\"]', 'buton');\n  }\n  nextLink() {\n    this.navigateToNextOfType('a[href]', 'link');\n  }\n  nextInput() {\n    this.navigateToNextOfType('input, textarea, select', 'câmp de input');\n  }\n  nextHeading() {\n    this.navigateToNextOfType('h1, h2, h3, h4, h5, h6', 'titlu');\n  }\n  navigateToNextOfType(selector, typeName) {\n    const elements = Array.from(document.querySelectorAll(selector)).filter(el => el.offsetParent !== null);\n    if (elements.length === 0) {\n      this.speak(`Nu există ${typeName} pe această pagină`, 'high');\n      return;\n    }\n    let nextIndex = -1;\n    if (this.focusedElement) {\n      const currentTypeIndex = elements.indexOf(this.focusedElement);\n      if (currentTypeIndex !== -1) {\n        nextIndex = (currentTypeIndex + 1) % elements.length;\n      } else {\n        const currentRect = this.focusedElement.getBoundingClientRect();\n        for (let i = 0; i < elements.length; i++) {\n          const rect = elements[i].getBoundingClientRect();\n          if (rect.top > currentRect.top || Math.abs(rect.top - currentRect.top) < 10 && rect.left > currentRect.left) {\n            nextIndex = i;\n            break;\n          }\n        }\n      }\n    }\n    if (nextIndex === -1) {\n      nextIndex = 0;\n    }\n    const targetElement = elements[nextIndex];\n    const globalIndex = this.focusableElements.indexOf(targetElement);\n    if (globalIndex !== -1) {\n      this.currentFocusIndex = globalIndex;\n      this.setFocus(targetElement);\n    }\n  }\n  adjustSpeed() {\n    const speeds = [0.7, 0.85, 1.0, 1.15, 1.3];\n    const currentIndex = speeds.indexOf(this.readingSpeed);\n    const nextIndex = (currentIndex + 1) % speeds.length;\n    this.readingSpeed = speeds[nextIndex];\n    this.speak(`Viteză de citire: ${Math.round(this.readingSpeed * 100)}%`, 'high');\n  }\n  speak(text, priority = 'normal') {\n    if (!text || text.trim() === '') return;\n    if (priority === 'high') {\n      this.stopReading();\n    }\n    const utterance = new SpeechSynthesisUtterance(text);\n    if (this.voice) {\n      utterance.voice = this.voice;\n    }\n    utterance.rate = this.readingSpeed;\n    utterance.pitch = 1.0;\n    utterance.volume = 1.0;\n    utterance.onstart = () => {\n      this.isReading = true;\n      this.currentUtterance = utterance;\n      document.dispatchEvent(new CustomEvent('speechStatusChanged', {\n        detail: {\n          isSpeaking: true\n        }\n      }));\n    };\n    utterance.onend = () => {\n      this.isReading = false;\n      this.currentUtterance = null;\n      this.processQueue();\n      document.dispatchEvent(new CustomEvent('speechStatusChanged', {\n        detail: {\n          isSpeaking: false\n        }\n      }));\n    };\n    utterance.onerror = e => {\n      console.error('Speech synthesis error:', e);\n      this.isReading = false;\n      this.currentUtterance = null;\n    };\n    if (this.isReading && priority !== 'high') {\n      this.readingQueue.push(utterance);\n    } else {\n      this.speechSynthesis.speak(utterance);\n    }\n  }\n\n  // METODĂ ÎMBUNĂTĂȚITĂ: navigare cu persistența modului de accesibilitate\n  navigateWithAccessibilityPersistence(destination, url) {\n    // Salvăm starea modului de accesibilitate\n    sessionStorage.setItem('accessibilityModeActive', this.isAccessibilityMode.toString());\n    this.navigationHistory.push(window.location.href);\n    this.speak(`Navighez la ${destination}`, 'high');\n\n    // Navigăm la URL\n    window.location.href = url;\n  }\n\n  // FIXAT: navigateBack pentru a merge la pagina anterioară din browser\n  navigateBack() {\n    this.speak(\"Navighez înapoi\", 'high');\n\n    // Persistăm modul de accesibilitate\n    sessionStorage.setItem('accessibilityModeActive', this.isAccessibilityMode.toString());\n\n    // Folosim history.back() pentru a merge la pagina anterioară din browser\n    window.history.back();\n  }\n  listAllElements() {\n    this.updateFocusableElements();\n    const totalElements = this.focusableElements.length;\n    const currentPosition = this.currentFocusIndex + 1;\n    let summary = `Pagina conține ${totalElements} elemente interactive. `;\n    summary += `Ești la elementul ${currentPosition} din ${totalElements}. `;\n    const counts = {\n      buttons: document.querySelectorAll('button, [role=\"button\"]').length,\n      links: document.querySelectorAll('a[href]').length,\n      inputs: document.querySelectorAll('input, textarea, select').length,\n      headings: document.querySelectorAll('h1, h2, h3, h4, h5, h6').length\n    };\n    summary += `Găsit: ${counts.buttons} butoane, ${counts.links} linkuri, `;\n    summary += `${counts.inputs} câmpuri de input, ${counts.headings} titluri.`;\n    this.speak(summary, 'high');\n  }\n\n  // METODE ÎMBUNĂTĂȚITE pentru navigare cu persistența accesibilității\n  navigateToCourses() {\n    this.navigateWithAccessibilityPersistence('cursuri', '/courses');\n  }\n  navigateToPlayground() {\n    this.navigateWithAccessibilityPersistence('playground', '/playground');\n  }\n  navigateToProfile() {\n    this.navigateWithAccessibilityPersistence('profil', '/profile');\n  }\n  goHome() {\n    this.navigateWithAccessibilityPersistence('pagina principală', '/');\n  }\n  selectQuizOption(index) {\n    const options = document.querySelectorAll('.question-container li');\n    if (options[index]) {\n      options[index].click();\n      this.speak(`Selectat răspunsul ${index + 1}`, 'high');\n    } else {\n      this.speak(`Nu există răspunsul ${index + 1}`, 'high');\n    }\n  }\n  executeCode() {\n    const runButton = document.querySelector('.editor-actions button[aria-label*=\"Execută\"]');\n    if (runButton) {\n      runButton.click();\n      this.speak(\"Execut codul\", 'high');\n    } else {\n      this.speak(\"Butonul de execuție nu a fost găsit\", 'high');\n    }\n  }\n  getFeedback() {\n    const feedbackButton = document.querySelector('.editor-actions button[aria-label*=\"feedback\"]');\n    if (feedbackButton) {\n      feedbackButton.click();\n      this.speak(\"Solicit feedback AI\", 'high');\n    } else {\n      this.speak(\"Butonul de feedback nu a fost găsit\", 'high');\n    }\n  }\n  readNavigationInfo() {\n    const currentUrl = window.location.pathname;\n    const totalElements = this.focusableElements.length;\n    const position = this.currentFocusIndex + 1;\n    let info = `Ești pe ${this.getPageName(currentUrl)}. `;\n    info += `Elementul curent: ${position} din ${totalElements}. `;\n    info += `Folosește Tab pentru navigare sau apasă F1 pentru ajutor.`;\n    this.speak(info, 'high');\n  }\n  getPageName(url) {\n    if (url === '/' || url === '') return 'pagina principală';\n    if (url.includes('/courses')) return 'pagina de cursuri';\n    if (url.includes('/playground')) return 'playground-ul de cod';\n    if (url.includes('/profile')) return 'pagina de profil';\n    if (url.includes('/login')) return 'pagina de autentificare';\n    if (url.includes('/register')) return 'pagina de înregistrare';\n    if (url.includes('/quiz')) return 'pagina de test';\n    return 'pagina curentă';\n  }\n  readHelp() {\n    const currentPage = this.getPageName(window.location.pathname);\n    const helpText = `\n      Ajutor pentru ${currentPage}.\n      \n      Comenzi esențiale:\n      - Tab și Shift Tab pentru navigare înainte și înapoi\n      - Enter pentru a activa elementul selectat\n      - Spațiu pentru pauză sau continuare citire\n      - Escape pentru oprire citire\n      \n      Navigare rapidă cu taste funcționale:\n      - F1 pentru acest ajutor\n      - F2 pentru autentificare\n      - F3 pentru înregistrare\n      \n      Navigare în site cu Alt:\n      - Alt C pentru cursuri\n      - Alt P pentru playground\n      - Alt R pentru profil\n      - Alt H pentru acasă\n      - Alt B pentru înapoi la pagina anterioară\n      \n      Navigare prin tipuri cu Ctrl:\n      - Ctrl B pentru butoane\n      - Ctrl L pentru linkuri\n      - Ctrl I pentru câmpuri input\n      - Ctrl T pentru titluri\n      \n      În modul editare:\n      - Alt Q pentru a citi linia curentă\n      - Alt W pentru a citi cuvântul curent\n      - Alt D pentru a comuta citirea live\n      - Escape pentru a ieși din editare\n      \n      Comenzi speciale:\n      - Alt M pentru citirea paginii\n      - Alt N pentru informații navigare\n      - Alt S pentru viteză citire\n      - Alt L pentru lista elementelor\n      \n      ${this.getPageSpecificHelp(currentPage)}\n    `;\n    this.speak(helpText, 'high');\n  }\n  getPageSpecificHelp(pageName) {\n    switch (pageName) {\n      case 'pagina de cursuri':\n        return 'În această pagină: Navighează prin cursuri cu Tab. Apasă Enter pentru a selecta un curs.';\n      case 'playground-ul de cod':\n        return 'În editor: Alt E pentru execuție, Alt F pentru feedback AI. În modul editare, săgețile sus/jos citesc linia curentă.';\n      case 'pagina de test':\n        return 'În test: Alt 1-4 pentru răspunsuri. Enter pentru verificare sau următoarea întrebare.';\n      case 'pagina de profil':\n        return 'În profil: Navighează prin secțiuni cu Tab. Enter pentru a modifica setările.';\n      case 'pagina de autentificare':\n      case 'pagina de înregistrare':\n        return 'Completează câmpurile cu Tab și Enter. În modul editare, tastează normal și folosește Escape când termini.';\n      default:\n        return 'Folosește Tab pentru navigare și F1 pentru ajutor.';\n    }\n  }\n  stopReading() {\n    if (this.speechSynthesis.speaking) {\n      this.speechSynthesis.cancel();\n    }\n    this.isReading = false;\n    this.currentUtterance = null;\n    this.readingQueue = [];\n    document.dispatchEvent(new CustomEvent('speechStatusChanged', {\n      detail: {\n        isSpeaking: false\n      }\n    }));\n  }\n  processQueue() {\n    if (this.readingQueue.length > 0 && !this.isReading) {\n      const nextUtterance = this.readingQueue.shift();\n      this.speechSynthesis.speak(nextUtterance);\n    }\n  }\n  toggleReading() {\n    if (this.isReading && this.currentUtterance) {\n      if (this.speechSynthesis.paused) {\n        this.speechSynthesis.resume();\n        this.speak(\"Reluare citire\", 'normal');\n      } else {\n        this.speechSynthesis.pause();\n        this.speak(\"Pauză citire\", 'normal');\n      }\n    } else {\n      this.readCurrentPage();\n    }\n  }\n  readCurrentPage() {\n    const pageContent = this.extractPageContent();\n    if (pageContent) {\n      this.speak(pageContent, 'high');\n    } else {\n      this.speak(\"Nu există conținut de citit pe această pagină\", 'high');\n    }\n  }\n  extractPageContent() {\n    let content = '';\n    const title = document.querySelector('h1');\n    if (title) {\n      content += `Titlu: ${title.textContent.trim()}. `;\n    }\n    const description = document.querySelector('.page-description, .course-detail-description, .code-playground-description');\n    if (description) {\n      content += `${description.textContent.trim()}. `;\n    }\n    const mainContent = document.querySelector('main, .body-content, .course-detail-content');\n    if (mainContent) {\n      const paragraphs = mainContent.querySelectorAll('p, h2, h3, h4, li');\n      paragraphs.forEach(p => {\n        const text = p.textContent.trim();\n        if (text && text.length > 0) {\n          content += `${text}. `;\n        }\n      });\n    }\n    const lessons = document.querySelectorAll('.course-preview-item, .lesson-title');\n    if (lessons.length > 0) {\n      content += 'Lecții disponibile: ';\n      lessons.forEach((lesson, index) => {\n        content += `${index + 1}. ${lesson.textContent.trim()}. `;\n      });\n    }\n    const currentQuestion = document.querySelector('.question-container h3');\n    if (currentQuestion) {\n      content += `Întrebare: ${currentQuestion.textContent.trim()}. `;\n      const options = document.querySelectorAll('.question-container li label');\n      if (options.length > 0) {\n        content += 'Opțiuni: ';\n        options.forEach((option, index) => {\n          content += `${index + 1}. ${option.textContent.trim()}. `;\n        });\n      }\n    }\n    return content.trim();\n  }\n  announce(message, priority = 'normal') {\n    this.speak(message, priority);\n  }\n  get isSpeaking() {\n    return this.isReading || this.speechSynthesis.speaking;\n  }\n  get isActive() {\n    return this.isAccessibilityMode;\n  }\n  readQuizQuestion(question, options) {\n    let text = `Întrebare: ${question}. `;\n    if (options && options.length > 0) {\n      text += 'Variantele de răspuns sunt: ';\n      options.forEach((option, index) => {\n        text += `${index + 1}: ${option}. `;\n      });\n    }\n    this.speak(text, 'high');\n  }\n  announceQuizResult(score, totalQuestions) {\n    const percentage = Math.round(score / totalQuestions * 100);\n    const text = `Test finalizat! Ai răspuns corect la ${score} din ${totalQuestions} întrebări. ` + `Scorul tău este ${percentage}%. ` + (percentage >= 80 ? 'Felicitări! Rezultat excelent!' : percentage >= 60 ? 'Rezultat bun! Continuă să înveți.' : 'Nu te descuraja! Încearcă din nou pentru un rezultat mai bun.');\n    this.speak(text, 'high');\n  }\n  readCodeLine(lineNumber, content) {\n    if (content) {\n      this.speak(`Linia ${lineNumber}: ${content}`, 'normal');\n    } else {\n      this.speak(`Linia ${lineNumber}: linie goală`, 'normal');\n    }\n  }\n  announceCodeChange(changeType, position) {\n    if (changeType === 'insert') {\n      this.speak(\"Text adăugat\", 'normal');\n    } else if (changeType === 'delete') {\n      this.speak(\"Text șters\", 'normal');\n    }\n  }\n\n  // Obține conținutul Monaco editor-ului\n  getMonacoContent(element) {\n    try {\n      if (window.monaco && window.monaco.editor) {\n        const editors = window.monaco.editor.getEditors();\n        const monacoContainer = element.closest('.monaco-editor') || element;\n        const editor = editors.find(e => monacoContainer.contains(e.getDomNode()));\n        if (editor) {\n          return editor.getValue();\n        }\n      }\n    } catch (e) {\n      console.error('Error getting Monaco content:', e);\n    }\n    return null;\n  }\n  addAccessibilityStyles() {\n    const style = document.createElement('style');\n    style.id = 'accessibility-styles';\n    style.textContent = `\n      /* Focus indicator pentru elementul curent */\n      .accessibility-focus {\n        outline: 3px solid #ffff00 !important;\n        outline-offset: 2px !important;\n        background-color: rgba(255, 255, 0, 0.1) !important;\n      }\n\n      /* Linkuri mai vizibile */\n      body.accessibility-mode a {\n        color: #00ffff !important;\n        text-decoration: underline !important;\n        font-weight: bold !important;\n      }\n      \n      /* Inputuri mai clare */\n      body.accessibility-mode input,\n      body.accessibility-mode textarea,\n      body.accessibility-mode select {\n        background: #111111 !important;\n        color: #ffffff !important;\n        border: 2px solid #ffffff !important;\n        padding: 10px !important;\n        font-size: 18px !important;\n      }\n      \n      body.accessibility-mode input:focus,\n      body.accessibility-mode textarea:focus,\n      body.accessibility-mode select:focus {\n        border-color: #ffff00 !important;\n        outline: 2px solid #ffff00 !important;\n      }\n      \n      /* Stil special pentru modul editare */\n      body.accessibility-mode input.accessibility-edit-mode,\n      body.accessibility-mode textarea.accessibility-edit-mode,\n      body.accessibility-mode select.accessibility-edit-mode {\n        border-color: #00ff00 !important;\n        outline: 2px solid #00ff00 !important;\n      }\n      \n      /* Simplificăm cardurile */\n      body.accessibility-mode .course-card,\n      body.accessibility-mode .feature-card,\n      body.accessibility-mode .example-card {\n        background: #111111 !important;\n        border: 2px solid #ffffff !important;\n        margin: 10px 0 !important;\n        padding: 20px !important;\n      }\n      \n      /* Eliminăm gradiente și efecte */\n      body.accessibility-mode [class*=\"gradient\"] {\n        background: #000000 !important;\n      }\n      \n      /* Indicator pentru elementul curent citit */\n      .accessibility-reading {\n        background-color: #333300 !important;\n        outline: 2px dashed #ffff00 !important;\n      }\n      \n      /* Simplificăm navigarea */\n      body.accessibility-mode nav {\n        background: #000000 !important;\n        border: 2px solid #ffffff !important;\n        padding: 10px !important;\n      }\n      \n      /* Indicator pentru modul editare activ */\n      body.accessibility-mode.editing::before {\n        content: \"MODUL EDITARE ACTIV\";\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: #00ff00;\n        color: #000000;\n        padding: 10px 20px;\n        font-weight: bold;\n        z-index: 10001;\n        border-radius: 5px;\n      }\n      \n      /* Indicator special pentru Monaco */\n      body.accessibility-mode.editing-monaco::before {\n        content: \"EDITOR DE COD ACTIV - ESCAPE PENTRU IEȘIRE\";\n        background: #0066ff;\n      }\n      \n      /* Stiluri speciale pentru Monaco Editor în modul accesibilitate */\n      body.accessibility-mode .monaco-editor {\n        background: #111111 !important;\n        border: 2px solid #ffffff !important;\n      }\n      \n      body.accessibility-mode .monaco-editor.accessibility-focus {\n        border-color: #ffff00 !important;\n        outline: 2px solid #ffff00 !important;\n      }\n      \n      body.accessibility-mode .monaco-editor .view-line {\n        color: #ffffff !important;\n      }\n      \n      body.accessibility-mode .monaco-editor .cursor {\n        background: #ffff00 !important;\n        width: 3px !important;\n      }\n      \n      /* Prevenim interferența cu Monaco */\n      body.accessibility-mode.editing-monaco * {\n        pointer-events: auto !important;\n      }\n      \n      /* FIXAT: Ascundem chenarul alb de pe pagina cu cursuri */\n      body.accessibility-mode .accessibility-navigation-info {\n        display: none !important;\n        visibility: hidden !important;\n        opacity: 0 !important;\n        position: absolute !important;\n        left: -9999px !important;\n        width: 1px !important;\n        height: 1px !important;\n      }\n    `;\n    document.head.appendChild(style);\n    document.body.classList.add('accessibility-mode');\n    document.body.setAttribute('data-accessibility-active', 'true');\n  }\n  removeAccessibilityStyles() {\n    const style = document.getElementById('accessibility-styles');\n    if (style) style.remove();\n    document.body.classList.remove('accessibility-mode', 'editing', 'editing-monaco');\n    document.body.removeAttribute('data-accessibility-active');\n    document.querySelectorAll('.accessibility-focus, .accessibility-reading, .accessibility-edit-mode').forEach(el => {\n      el.classList.remove('accessibility-focus', 'accessibility-reading', 'accessibility-edit-mode');\n    });\n  }\n\n  // METODĂ NOUĂ: Inițializare din sessionStorage\n  initializeFromStorage() {\n    const savedState = sessionStorage.getItem('accessibilityModeActive');\n    if (savedState === 'true') {\n      // Reactivăm modul de accesibilitate fără să anunțăm\n      this.isAccessibilityMode = true;\n      this.addAccessibilityStyles();\n      this.updateFocusableElements();\n\n      // Anunțăm că modul este activ\n      setTimeout(() => {\n        this.speak(\"Modul pentru nevăzători este activ pe această pagină.\", 'high');\n      }, 1000);\n      document.dispatchEvent(new CustomEvent('accessibilityModeChanged', {\n        detail: {\n          isActive: true\n        }\n      }));\n    }\n  }\n}\n\n// Exportăm o instanță singleton cu inițializare automată\nconst accessibilityManager = new AccessibilityManager();\n\n// Inițializăm din storage la încărcarea paginii\ndocument.addEventListener('DOMContentLoaded', () => {\n  accessibilityManager.initializeFromStorage();\n});\nexport default accessibilityManager;","map":{"version":3,"names":["AccessibilityManager","constructor","isAccessibilityMode","speechSynthesis","window","currentUtterance","voice","isReading","readingQueue","shortcuts","Map","focusedElement","navigationMode","currentFocusIndex","focusableElements","navigationHistory","readingSpeed","isEditMode","currentEditElement","lastTypedChar","typingTimer","waitingForEditorChoice","currentEditorElement","liveReadingEnabled","readFullWords","charEchoEnabled","isInMonacoEditor","monacoActive","initializeVoice","setupGlobalListeners","registerShortcuts","setVoice","voices","getVoices","romanianVoiceNames","selectedVoice","voiceName","find","name","toLowerCase","includes","lang","startsWith","console","log","warn","forEach","length","addEventListener","setTimeout","accessibilityManager","document","e","inMonaco","isMonacoRelated","target","activeElement","clickedMonaco","key","preventDefault","stopPropagation","stopImmediatePropagation","exitMonacoEditor","ctrlKey","shiftKey","toggleAccessibilityMode","handleEditModeKeydown","handleAccessibilityShortcuts","handleLiveReading","observer","MutationObserver","updateFocusableElements","observe","body","childList","subtree","element","nodeType","monacoIndicators","currentElement","depth","maxDepth","classList","indicator","contains","slice","id","getAttribute","_currentElement$getAt","matches","parentElement","set","navigateNext","navigatePrevious","activateElement","toggleReading","stopReading","readHelp","navigateToLogin","navigateToRegister","navigateToCourses","navigateToPlayground","navigateToProfile","goHome","readCurrentPage","readNavigationInfo","adjustSpeed","navigateBack","listAllElements","nextButton","nextLink","nextInput","nextHeading","selectQuizOption","executeCode","getFeedback","readCurrentLine","readCurrentWord","toggleLiveReading","push","location","href","speak","readPageSpecificHelp","currentPage","getPageName","pathname","helpText","exitEditMode","altKey","readCharacterAtCursor","tagName","clearTimeout","inputType","type","data","getCharDescription","word","getCurrentWord","char","charDescriptions","value","textContent","cursorPos","selectionStart","start","end","test","substring","trim","lines","split","currentLineIndex","charCount","i","currentLine","enterMonacoEditor","enterEditMode","click","monacoContainer","closest","focusTargets","focused","selector","querySelector","focus","add","dispatchEvent","CustomEvent","detail","isActive","monacoElements","querySelectorAll","el","blur","remove","container","setFocus","announcement","getEditModeInstructions","instructions","addAccessibilityStyles","readWelcomeMessage","removeAccessibilityStyles","welcomeText","getShortcutKey","handler","get","parts","join","selectors","Array","from","filter","rect","getBoundingClientRect","width","height","offsetParent","_document$querySelect","activeTab","sort","a","b","rectA","rectB","Math","abs","top","left","scrollIntoView","behavior","block","inline","readElementInfo","_element$textContent","_document$querySelect2","_document$querySelect3","_element$options$elem","_document$querySelect4","description","ariaLabel","text","codeContent","getMonacoContent","inputLabel","inputValue","placeholder","checked","selectLabel","selectedOption","options","selectedIndex","textareaLabel","level","charAt","_element$querySelecto","_element$querySelecto2","title","desc","_element$querySelecto3","_element$querySelecto4","label","_element$querySelecto5","_element$querySelecto6","_element$querySelecto7","_element$querySelecto8","_element$querySelecto9","isUnlocked","navigateToSection","sectionName","section","firstFocusable","index","indexOf","navigateToNextOfType","typeName","elements","nextIndex","currentTypeIndex","currentRect","targetElement","globalIndex","speeds","currentIndex","round","priority","utterance","SpeechSynthesisUtterance","rate","pitch","volume","onstart","isSpeaking","onend","processQueue","onerror","error","navigateWithAccessibilityPersistence","destination","url","sessionStorage","setItem","toString","history","back","totalElements","currentPosition","summary","counts","buttons","links","inputs","headings","runButton","feedbackButton","currentUrl","position","info","getPageSpecificHelp","pageName","speaking","cancel","nextUtterance","shift","paused","resume","pause","pageContent","extractPageContent","content","mainContent","paragraphs","p","lessons","lesson","currentQuestion","option","announce","message","readQuizQuestion","question","announceQuizResult","score","totalQuestions","percentage","readCodeLine","lineNumber","announceCodeChange","changeType","monaco","editor","editors","getEditors","getDomNode","getValue","style","createElement","head","appendChild","setAttribute","getElementById","removeAttribute","initializeFromStorage","savedState","getItem"],"sources":["C:/Users/rares/Documents/licentaV3/java-verse/src/utils/AccessibilityManager.js"],"sourcesContent":["// src/utils/AccessibilityManager.js - Fixed version\r\nclass AccessibilityManager {\r\n  constructor() {\r\n    this.isAccessibilityMode = false;\r\n    this.speechSynthesis = window.speechSynthesis;\r\n    this.currentUtterance = null;\r\n    this.voice = null;\r\n    this.isReading = false;\r\n    this.readingQueue = [];\r\n    this.shortcuts = new Map();\r\n    this.focusedElement = null;\r\n    this.navigationMode = 'normal';\r\n    this.currentFocusIndex = 0;\r\n    this.focusableElements = [];\r\n    this.navigationHistory = [];\r\n    this.readingSpeed = 1.0;\r\n    \r\n    // Mod de editare\r\n    this.isEditMode = false;\r\n    this.currentEditElement = null;\r\n    this.lastTypedChar = '';\r\n    this.typingTimer = null;\r\n    \r\n    // Pentru alegerea editorului\r\n    this.waitingForEditorChoice = false;\r\n    this.currentEditorElement = null;\r\n    \r\n    // Setări pentru citire live\r\n    this.liveReadingEnabled = true;\r\n    this.readFullWords = true;\r\n    this.charEchoEnabled = true;\r\n    \r\n    // Flag special pentru Monaco Editor\r\n    this.isInMonacoEditor = false;\r\n    this.monacoActive = false;\r\n    \r\n    this.initializeVoice();\r\n    this.setupGlobalListeners();\r\n    this.registerShortcuts();\r\n  }\r\n\r\n  initializeVoice() {\r\n    const setVoice = () => {\r\n      const voices = this.speechSynthesis.getVoices();\r\n      \r\n      // Lista de voci românești preferate (în ordinea preferinței)\r\n      const romanianVoiceNames = [\r\n        'Microsoft Andrei - Romanian (Romania)',\r\n        'Microsoft Ioana - Romanian (Romania)',\r\n        'Google română',\r\n        'Romanian Romania',\r\n        'Romanian Female',\r\n        'Romanian Male'\r\n      ];\r\n      \r\n      // Căutăm mai întâi după nume specific\r\n      let selectedVoice = null;\r\n      for (const voiceName of romanianVoiceNames) {\r\n        selectedVoice = voices.find(voice => \r\n          voice.name.toLowerCase().includes(voiceName.toLowerCase())\r\n        );\r\n        if (selectedVoice) break;\r\n      }\r\n      \r\n      // Dacă nu găsim după nume, căutăm după cod de limbă\r\n      if (!selectedVoice) {\r\n        selectedVoice = voices.find(voice => voice.lang === 'ro-RO') || \r\n                       voices.find(voice => voice.lang.startsWith('ro')) ||\r\n                       voices.find(voice => voice.lang.includes('ro'));\r\n      }\r\n      \r\n      // Fallback la prima voce disponibilă\r\n      this.voice = selectedVoice || voices[0];\r\n      \r\n      // Afișăm informații despre vocea selectată\r\n      if (this.voice) {\r\n        console.log(`Voce selectată: ${this.voice.name} (${this.voice.lang})`);\r\n        \r\n        // Anunțăm utilizatorul despre vocea selectată\r\n        if (this.voice.lang.startsWith('ro')) {\r\n          console.log('✓ Voce românească activată cu succes!');\r\n        } else {\r\n          console.warn('⚠ Nu s-a găsit o voce românească. Folosesc:', this.voice.name);\r\n          console.log('Sugestie: Instalați o voce românească în sistemul de operare.');\r\n        }\r\n      }\r\n      \r\n      // Listăm toate vocile disponibile pentru debugging\r\n      console.log('Voci disponibile:');\r\n      voices.forEach(voice => {\r\n        if (voice.lang.includes('ro')) {\r\n          console.log(`  ✓ ${voice.name} - ${voice.lang} (Română)`);\r\n        }\r\n      });\r\n    };\r\n\r\n    // Încercăm să setăm vocea imediat\r\n    if (this.speechSynthesis.getVoices().length > 0) {\r\n      setVoice();\r\n    } else {\r\n      // Așteptăm ca vocile să se încarce\r\n      this.speechSynthesis.addEventListener('voiceschanged', setVoice);\r\n    }\r\n    \r\n    // Forțăm o reîncărcare după 100ms pentru siguranță\r\n    setTimeout(() => {\r\n      if (!this.voice || !this.voice.lang.includes('ro')) {\r\n        setVoice();\r\n      }\r\n    }, 100);\r\n  }\r\n\r\n  setupGlobalListeners() {\r\n    // Expunem managerul la nivel global pentru verificări\r\n    window.accessibilityManager = this;\r\n    \r\n    // Detectăm când intrăm/ieșim din Monaco prin multiple metode\r\n    document.addEventListener('focusin', (e) => {\r\n      const inMonaco = this.isMonacoRelated(e.target);\r\n      if (inMonaco && !this.monacoActive) {\r\n        this.monacoActive = true;\r\n        this.isInMonacoEditor = true;\r\n        console.log('📝 Monaco Editor ACTIVATED - ALL accessibility disabled');\r\n      }\r\n    }, true);\r\n    \r\n    document.addEventListener('focusout', (e) => {\r\n      // Verificăm după un mic delay dacă am ieșit complet din Monaco\r\n      setTimeout(() => {\r\n        const activeElement = document.activeElement;\r\n        if (!this.isMonacoRelated(activeElement) && this.monacoActive) {\r\n          this.monacoActive = false;\r\n          this.isInMonacoEditor = false;\r\n          console.log('📝 Monaco Editor DEACTIVATED - Accessibility re-enabled');\r\n        }\r\n      }, 50);\r\n    }, true);\r\n    \r\n    // Click detection pentru Monaco\r\n    document.addEventListener('click', (e) => {\r\n      if (this.isAccessibilityMode) {\r\n        const clickedMonaco = this.isMonacoRelated(e.target);\r\n        if (clickedMonaco !== this.monacoActive) {\r\n          this.monacoActive = clickedMonaco;\r\n          this.isInMonacoEditor = clickedMonaco;\r\n          console.log(`📝 Monaco state changed via click: ${clickedMonaco}`);\r\n        }\r\n      }\r\n    }, true);\r\n    \r\n    // CRITICAL: Keydown handler cu verificare strictă pentru Monaco\r\n    document.addEventListener('keydown', (e) => {\r\n      // Dacă Monaco este activ, procesăm DOAR Escape și Ctrl+Shift+A\r\n      if (this.monacoActive && this.isAccessibilityMode) {\r\n        if (e.key === 'Escape') {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          e.stopImmediatePropagation();\r\n          this.exitMonacoEditor();\r\n          return false;\r\n        }\r\n        // Permitem Ctrl+Shift+A pentru a dezactiva modul accesibilitate complet\r\n        if (e.ctrlKey && e.shiftKey && e.key === 'A') {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          e.stopImmediatePropagation();\r\n          this.toggleAccessibilityMode();\r\n          return false;\r\n        }\r\n        // BLOCARE TOTALĂ pentru orice altă tastă\r\n        return;\r\n      }\r\n      \r\n      // Ctrl + Shift + A pentru activarea modului (în afara Monaco)\r\n      if (e.ctrlKey && e.shiftKey && e.key === 'A') {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.toggleAccessibilityMode();\r\n        return;\r\n      }\r\n\r\n      if (!this.isAccessibilityMode) {\r\n        return;\r\n      }\r\n\r\n      // În modul editare pentru alte elemente (non-Monaco)\r\n      if (this.isEditMode && !this.monacoActive) {\r\n        this.handleEditModeKeydown(e);\r\n        return;\r\n      }\r\n\r\n      // Prevenim comportamentul default doar pentru taste speciale în modul navigare\r\n      if (!this.isEditMode && ['Tab', 'Enter', ' ', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n\r\n      this.handleAccessibilityShortcuts(e);\r\n    }, true); // Capture phase pentru prioritate maximă\r\n    \r\n    // Blocăm și keyup în Monaco pentru siguranță\r\n    document.addEventListener('keyup', (e) => {\r\n      if (this.monacoActive && this.isAccessibilityMode) {\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n      }\r\n    }, true);\r\n    \r\n    // Blocăm și keypress în Monaco\r\n    document.addEventListener('keypress', (e) => {\r\n      if (this.monacoActive && this.isAccessibilityMode) {\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n      }\r\n    }, true);\r\n    \r\n    // Handler pentru input events\r\n    document.addEventListener('input', (e) => {\r\n      // Dacă suntem în Monaco, nu procesăm deloc\r\n      if (this.monacoActive || this.isInMonacoEditor) {\r\n        return;\r\n      }\r\n      \r\n      if (this.isAccessibilityMode && this.isEditMode && this.liveReadingEnabled) {\r\n        this.handleLiveReading(e);\r\n      }\r\n    }, true);\r\n\r\n    // Actualizăm lista de elemente focusabile când se schimbă DOM-ul\r\n    const observer = new MutationObserver(() => {\r\n      if (this.isAccessibilityMode && !this.isEditMode && !this.monacoActive) {\r\n        this.updateFocusableElements();\r\n      }\r\n    });\r\n\r\n    observer.observe(document.body, {\r\n      childList: true,\r\n      subtree: true\r\n    });\r\n  }\r\n\r\n  // Metodă îmbunătățită pentru detectarea Monaco\r\n  isMonacoRelated(element) {\r\n    if (!element || !element.nodeType) return false;\r\n    \r\n    // Listă extinsă de indicatori Monaco\r\n    const monacoIndicators = [\r\n      // Clase Monaco\r\n      '.monaco-editor',\r\n      '.overflow-guard',\r\n      '.inputarea',\r\n      '.view-line',\r\n      '.view-lines',\r\n      '.lines-content',\r\n      '.monaco-editor-background',\r\n      '.monaco-scrollable-element',\r\n      '.cursor',\r\n      '.cursors-layer',\r\n      '.minimap',\r\n      '.decorationsOverviewRuler',\r\n      '.editor-container',\r\n      '.editor-widget',\r\n      \r\n      // ID-uri și atribute\r\n      '#code-editor',\r\n      '[data-uri*=\"monaco\"]',\r\n      '[data-mode-id]',\r\n      \r\n      // Containere custom\r\n      '.code-editor',\r\n      '.editor-wrapper',\r\n      '.code-editor-container',\r\n      '.monaco-container'\r\n    ];\r\n    \r\n    // Verificăm elementul și toți părinții\r\n    let currentElement = element;\r\n    let depth = 0;\r\n    const maxDepth = 15; // Limităm adâncimea pentru performanță\r\n    \r\n    while (currentElement && depth < maxDepth) {\r\n      // Verificare clase directe\r\n      if (currentElement.classList) {\r\n        for (const indicator of monacoIndicators) {\r\n          if (indicator.startsWith('.') && currentElement.classList.contains(indicator.slice(1))) {\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Verificare ID\r\n      if (currentElement.id === 'code-editor') {\r\n        return true;\r\n      }\r\n      \r\n      // Verificare atribute\r\n      if (currentElement.getAttribute) {\r\n        if (currentElement.getAttribute('data-uri')?.includes('monaco') ||\r\n            currentElement.getAttribute('data-mode-id') ||\r\n            currentElement.getAttribute('role') === 'code' ||\r\n            currentElement.getAttribute('data-monaco-editor') === 'true') {\r\n          return true;\r\n        }\r\n      }\r\n      \r\n      // Verificare querySelector pentru toate indicatoarele\r\n      for (const indicator of monacoIndicators) {\r\n        if (currentElement.matches && currentElement.matches(indicator)) {\r\n          return true;\r\n        }\r\n      }\r\n      \r\n      currentElement = currentElement.parentElement;\r\n      depth++;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  registerShortcuts() {\r\n    // Comenzi de navigare principală\r\n    this.shortcuts.set('Tab', () => this.navigateNext());\r\n    this.shortcuts.set('Shift+Tab', () => this.navigatePrevious());\r\n    this.shortcuts.set('Enter', () => this.activateElement());\r\n    this.shortcuts.set(' ', () => this.toggleReading());\r\n    this.shortcuts.set('Escape', () => this.stopReading());\r\n    \r\n    // Navigare rapidă cu F-keys - MODIFICAT pentru F2 și F3\r\n    this.shortcuts.set('F1', () => this.readHelp());\r\n    this.shortcuts.set('F2', () => this.navigateToLogin()); // NOU - pentru login\r\n    this.shortcuts.set('F3', () => this.navigateToRegister()); // NOU - pentru register\r\n    // F4 eliminat complet\r\n    \r\n    // Navigare în pagini\r\n    this.shortcuts.set('alt+c', () => this.navigateToCourses());\r\n    this.shortcuts.set('alt+p', () => this.navigateToPlayground());\r\n    this.shortcuts.set('alt+r', () => this.navigateToProfile());\r\n    this.shortcuts.set('alt+h', () => this.goHome());\r\n    \r\n    // Comenzi utilitare\r\n    this.shortcuts.set('alt+m', () => this.readCurrentPage());\r\n    this.shortcuts.set('alt+n', () => this.readNavigationInfo());\r\n    this.shortcuts.set('alt+s', () => this.adjustSpeed());\r\n    this.shortcuts.set('alt+b', () => this.navigateBack()); // FIXAT - înapoi la pagina anterioară\r\n    this.shortcuts.set('alt+l', () => this.listAllElements());\r\n    \r\n    // Navigare prin elemente similare\r\n    this.shortcuts.set('ctrl+b', () => this.nextButton());\r\n    this.shortcuts.set('ctrl+l', () => this.nextLink());\r\n    this.shortcuts.set('ctrl+i', () => this.nextInput());\r\n    this.shortcuts.set('ctrl+t', () => this.nextHeading());\r\n    \r\n    // Navigare în quiz\r\n    this.shortcuts.set('alt+1', () => this.selectQuizOption(0));\r\n    this.shortcuts.set('alt+2', () => this.selectQuizOption(1));\r\n    this.shortcuts.set('alt+3', () => this.selectQuizOption(2));\r\n    this.shortcuts.set('alt+4', () => this.selectQuizOption(3));\r\n    \r\n    // Comenzi pentru editor de cod\r\n    this.shortcuts.set('alt+e', () => this.executeCode());\r\n    this.shortcuts.set('alt+f', () => this.getFeedback());\r\n    \r\n    // Comenzi pentru modul editare\r\n    this.shortcuts.set('alt+q', () => this.readCurrentLine());\r\n    this.shortcuts.set('alt+w', () => this.readCurrentWord());\r\n    this.shortcuts.set('alt+d', () => this.toggleLiveReading());\r\n  }\r\n\r\n  // METODĂ NOUĂ pentru F2 - login\r\n  navigateToLogin() {\r\n    this.navigationHistory.push(window.location.href);\r\n    this.speak(\"Navighez la autentificare\", 'high');\r\n    window.location.href = '/login';\r\n  }\r\n\r\n  // METODĂ NOUĂ pentru F3 - register\r\n  navigateToRegister() {\r\n    this.navigationHistory.push(window.location.href);\r\n    this.speak(\"Navighez la înregistrare\", 'high');\r\n    window.location.href = '/register';\r\n  }\r\n  // METODĂ NOUĂ: F4 pentru ajutor specific paginii\r\n  readPageSpecificHelp() {\r\n    const currentPage = this.getPageName(window.location.pathname);\r\n    \r\n    let helpText = `Ajutor pentru ${currentPage}:\\n\\n`;\r\n    \r\n    switch (currentPage) {\r\n      case 'pagina principală':\r\n        helpText += `\r\n          Navigare:\r\n          - Tab pentru a naviga prin elemente\r\n          - Enter pentru a activa linkurile și butoanele\r\n          - Alt + C pentru a merge direct la cursuri\r\n          \r\n          Caracteristici disponibile:\r\n          - Cursuri Java interactive\r\n          - Playground pentru experimentare cu cod\r\n          - Sistem de progres și realizări\r\n        `;\r\n        break;\r\n        \r\n      case 'pagina de cursuri':\r\n        helpText += `\r\n          Navigare prin cursuri:\r\n          - Săgeata sus/jos pentru a naviga prin cursuri\r\n          - Enter pentru a selecta un curs\r\n          - Escape pentru a opri citirea\r\n          \r\n          Informații utile:\r\n          - Fiecare curs conține multiple lecții\r\n          - Progresul se salvează automat\r\n          - La sfârșit vei susține un test\r\n        `;\r\n        break;\r\n        \r\n      case 'playground-ul de cod':\r\n        helpText += `\r\n          Comenzi pentru playground:\r\n          - Săgeata sus/jos pentru navigare prin exemple\r\n          - Enter pentru a activa/dezactiva editorul de cod\r\n          - Alt + E pentru execuția codului (când editorul este activ)\r\n          - Alt + F pentru feedback AI\r\n          - Escape pentru a ieși din editorul de cod\r\n          \r\n          Funcționalități:\r\n          - Editare de cod în timp real\r\n          - Execuție instant a codului Java\r\n          - Feedback inteligent de la AI\r\n          - Exemple predefinite pentru învățare\r\n        `;\r\n        break;\r\n        \r\n      case 'pagina de profil':\r\n        helpText += `\r\n          Navigare în profil:\r\n          - Tab pentru navigare prin secțiuni\r\n          - Enter pentru a accesa diferitele tab-uri\r\n          - Butonul Continuă pentru a relua cursurile\r\n          \r\n          Secțiuni disponibile:\r\n          - Cursurile Mele: vezi progresul cursurilor\r\n          - Realizări: vezi badge-urile câștigate\r\n          - Setări: personalizează contul\r\n        `;\r\n        break;\r\n        \r\n      case 'pagina de test':\r\n        helpText += `\r\n          Comenzi pentru test:\r\n          - Tastele 1-4 pentru selectarea răspunsurilor\r\n          - Enter pentru validarea răspunsului\r\n          - Escape pentru a opri citirea\r\n          \r\n          La sfârșitul testului:\r\n          - R pentru a relua testul\r\n          - Alt + R pentru a merge la profil\r\n          - Alt + C pentru a reveni la cursuri\r\n          \r\n          Sfaturi:\r\n          - Ascultă întrebarea complet înainte de a răspunde\r\n          - Poți schimba răspunsul înainte de validare\r\n        `;\r\n        break;\r\n        \r\n      case 'pagina de autentificare':\r\n      case 'pagina de înregistrare':\r\n        helpText += `\r\n          Completarea formularului:\r\n          - Tab pentru navigare între câmpuri\r\n          - Enter pentru a intra în modul editare\r\n          - Escape pentru a ieși din modul editare\r\n          - Enter pe buton pentru trimiterea formularului\r\n          \r\n          Notă:\r\n          - Pentru câmpurile de parolă, caracterele nu se citesc pentru securitate\r\n          - Toate câmpurile marcate sunt obligatorii\r\n        `;\r\n        break;\r\n        \r\n      default:\r\n        helpText += `\r\n          Comenzi generale:\r\n          - Tab și Shift + Tab pentru navigare\r\n          - Enter pentru activarea elementelor\r\n          - F1 pentru ajutorul complet\r\n          - Alt + B pentru înapoi\r\n          \r\n          Navigare rapidă:\r\n          - Alt + C pentru cursuri\r\n          - Alt + P pentru playground\r\n          - Alt + R pentru profil\r\n          - Alt + H pentru acasă\r\n        `;\r\n        break;\r\n    }    \r\n    this.speak(helpText, 'high');\r\n  }\r\n\r\n  handleEditModeKeydown(e) {\r\n    // Această funcție este apelată doar pentru non-Monaco editors\r\n    if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      this.exitEditMode();\r\n      return;\r\n    }\r\n    \r\n    if (e.altKey && e.key === 'q') {\r\n      e.preventDefault();\r\n      this.readCurrentLine();\r\n      return;\r\n    }\r\n    \r\n    if (e.altKey && e.key === 'w') {\r\n      e.preventDefault();\r\n      this.readCurrentWord();\r\n      return;\r\n    }\r\n    \r\n    if (e.altKey && e.key === 'd') {\r\n      e.preventDefault();\r\n      this.toggleLiveReading();\r\n      return;\r\n    }\r\n    \r\n    // Pentru input-uri normale - citire la navigare stânga/dreapta\r\n    if (['ArrowLeft', 'ArrowRight'].includes(e.key)) {\r\n      setTimeout(() => {\r\n        this.readCharacterAtCursor();\r\n      }, 50);\r\n    }\r\n  }\r\n\r\n  handleLiveReading(e) {\r\n    const target = e.target;\r\n    \r\n    // Pentru Monaco Editor, nu procesăm\r\n    if (this.isMonacoRelated(target)) {\r\n      return;\r\n    }\r\n    \r\n    if (!['INPUT', 'TEXTAREA'].includes(target.tagName)) {\r\n      return;\r\n    }\r\n    \r\n    // Anulăm timer-ul anterior\r\n    if (this.typingTimer) {\r\n      clearTimeout(this.typingTimer);\r\n    }\r\n    \r\n    // FIXAT: Pentru câmpurile de parolă, nu citim caracterele\r\n    const inputType = target.type;\r\n    if (inputType === 'password') {\r\n      // Pentru parolă, nu citim caracterele individual\r\n      return;\r\n    }\r\n    \r\n    // Citim caracterul tastat imediat - ÎMBUNĂTĂȚIT pentru punctuație\r\n    if (this.charEchoEnabled && e.data) {\r\n      this.speak(this.getCharDescription(e.data), 'high');\r\n    }\r\n    \r\n    // Setăm un timer pentru a citi cuvântul complet\r\n    if (this.readFullWords) {\r\n      this.typingTimer = setTimeout(() => {\r\n        const word = this.getCurrentWord(target);\r\n        if (word && word.length > 1) {\r\n          this.speak(`Cuvânt: ${word}`, 'normal');\r\n        }\r\n      }, 500);\r\n    }\r\n  }\r\n\r\n  // ÎMBUNĂTĂȚIRE: Descrierea caracterelor cu semne de punctuație\r\n  getCharDescription(char) {\r\n    const charDescriptions = {\r\n      ' ': 'spațiu',\r\n      '.': 'punct',\r\n      ',': 'virgulă',\r\n      ';': 'punct și virgulă',\r\n      ':': 'două puncte',\r\n      '!': 'semnul exclamării',\r\n      '?': 'semnul întrebării',\r\n      '\"': 'ghilimele',\r\n      \"'\": 'apostrof',\r\n      '(': 'paranteză deschisă',\r\n      ')': 'paranteză închisă',\r\n      '[': 'paranteză pătrată deschisă',\r\n      ']': 'paranteză pătrată închisă',\r\n      '{': 'acoladă deschisă',\r\n      '}': 'acoladă închisă',\r\n      '<': 'mai mic',\r\n      '>': 'mai mare',\r\n      '=': 'egal',\r\n      '+': 'plus',\r\n      '-': 'minus',\r\n      '*': 'asterisc',\r\n      '/': 'slash',\r\n      '\\\\': 'backslash',\r\n      '@': 'arobase',\r\n      '#': 'diez',\r\n      '$': 'dolar',\r\n      '%': 'procent',\r\n      '^': 'circumflex',\r\n      '&': 'ampersand',\r\n      '_': 'underscore',\r\n      '|': 'bară verticală',\r\n      '~': 'tildă',\r\n      '`': 'accent grav',\r\n      '\\n': 'linie nouă',\r\n      '\\t': 'tab'\r\n    };\r\n    \r\n    return charDescriptions[char] || char;\r\n  }\r\n\r\n  getCurrentWord(element) {\r\n    const value = element.value || element.textContent;\r\n    const cursorPos = element.selectionStart || value.length;\r\n    \r\n    let start = cursorPos;\r\n    let end = cursorPos;\r\n    \r\n    while (start > 0 && !/\\s/.test(value[start - 1])) {\r\n      start--;\r\n    }\r\n    \r\n    while (end < value.length && !/\\s/.test(value[end])) {\r\n      end++;\r\n    }\r\n    \r\n    return value.substring(start, end).trim();\r\n  }\r\n\r\n  readCurrentLine() {\r\n    if (!this.currentEditElement) {\r\n      this.speak(\"Nu ești într-un câmp de editare\", 'high');\r\n      return;\r\n    }\r\n    \r\n    // Pentru Monaco Editor - versiune simplificată\r\n    if (this.isMonacoRelated(this.currentEditElement)) {\r\n      this.speak(\"Citirea liniei în Monaco Editor nu este disponibilă momentan\", 'high');\r\n      return;\r\n    }\r\n    \r\n    const element = this.currentEditElement;\r\n    \r\n    if (element.tagName === 'TEXTAREA') {\r\n      const value = element.value || '';\r\n      const cursorPos = element.selectionStart || 0;\r\n      \r\n      const lines = value.split('\\n');\r\n      let currentLineIndex = 0;\r\n      let charCount = 0;\r\n      \r\n      for (let i = 0; i < lines.length; i++) {\r\n        charCount += lines[i].length + 1;\r\n        if (charCount > cursorPos) {\r\n          currentLineIndex = i;\r\n          break;\r\n        }\r\n      }\r\n      \r\n      const currentLine = lines[currentLineIndex];\r\n      if (currentLine.trim()) {\r\n        this.speak(`Linia ${currentLineIndex + 1}: ${currentLine}`, 'high');\r\n      } else {\r\n        this.speak(`Linia ${currentLineIndex + 1}: linie goală`, 'high');\r\n      }\r\n    } else {\r\n      const value = element.value;\r\n      if (value) {\r\n        this.speak(`Conținut: ${value}`, 'high');\r\n      } else {\r\n        this.speak(\"Câmp gol\", 'high');\r\n      }\r\n    }\r\n  }\r\n  \r\n  readCurrentWord() {\r\n    if (!this.currentEditElement) {\r\n      this.speak(\"Nu ești într-un câmp de editare\", 'high');\r\n      return;\r\n    }\r\n    \r\n    // Pentru Monaco Editor - versiune simplificată\r\n    if (this.isMonacoRelated(this.currentEditElement)) {\r\n      this.speak(\"Citirea cuvântului în Monaco Editor nu este disponibilă momentan\", 'high');\r\n      return;\r\n    }\r\n    \r\n    const word = this.getCurrentWord(this.currentEditElement);\r\n    if (word) {\r\n      this.speak(`Cuvânt: ${word}`, 'high');\r\n    } else {\r\n      this.speak(\"Nu există cuvânt la poziția curentă\", 'high');\r\n    }\r\n  }\r\n\r\n  readCharacterAtCursor() {\r\n    if (!this.currentEditElement) return;\r\n    \r\n    const element = this.currentEditElement;\r\n    const value = element.value;\r\n    const cursorPos = element.selectionStart;\r\n    \r\n    if (cursorPos < value.length) {\r\n      const char = value[cursorPos];\r\n      this.speak(this.getCharDescription(char), 'high');\r\n    } else {\r\n      this.speak(\"Sfârșit de text\", 'high');\r\n    }\r\n  }\r\n\r\n  toggleLiveReading() {\r\n    this.liveReadingEnabled = !this.liveReadingEnabled;\r\n    this.speak(\r\n      this.liveReadingEnabled \r\n        ? \"Citire live activată\" \r\n        : \"Citire live dezactivată\", \r\n      'high'\r\n    );\r\n  }\r\n\r\n  activateElement() {\r\n    if (!this.focusedElement) {\r\n      this.speak(\"Niciun element selectat\", 'high');\r\n      return;\r\n    }\r\n    \r\n    const tagName = this.focusedElement.tagName.toLowerCase();\r\n    \r\n    // Pentru Monaco Editor - activare specială\r\n    if (this.isMonacoRelated(this.focusedElement)) {\r\n      this.enterMonacoEditor(this.focusedElement);\r\n      return;\r\n    }\r\n    \r\n    // Pentru inputuri normale\r\n    if (['input', 'textarea', 'select'].includes(tagName)) {\r\n      this.enterEditMode(this.focusedElement);\r\n      return;\r\n    }\r\n    \r\n    // Pentru alte elemente\r\n    this.speak(\"Activez elementul\", 'normal');\r\n    \r\n    if (this.focusedElement.click) {\r\n      this.focusedElement.click();\r\n    } else if (tagName === 'a') {\r\n      window.location.href = this.focusedElement.href;\r\n    }\r\n  }\r\n\r\n  enterMonacoEditor(element) {\r\n    // Setăm flagurile înainte de orice altceva\r\n    this.monacoActive = true;\r\n    this.isInMonacoEditor = true;\r\n    this.isEditMode = true;\r\n    this.currentEditElement = element;\r\n    \r\n    // Găsim containerul Monaco\r\n    const monacoContainer = element.classList.contains('monaco-editor') \r\n      ? element \r\n      : element.closest('.monaco-editor') || element.closest('.editor-wrapper') || element;\r\n    \r\n    // Focusăm editorul Monaco\r\n    setTimeout(() => {\r\n      // Căutăm diferite elemente care pot primi focus în Monaco\r\n      const focusTargets = [\r\n        '.inputarea',\r\n        '.monaco-editor textarea',\r\n        '[role=\"textbox\"]',\r\n        '.view-lines',\r\n        '.monaco-editor'\r\n      ];\r\n      \r\n      let focused = false;\r\n      for (const selector of focusTargets) {\r\n        const target = monacoContainer.querySelector(selector);\r\n        if (target) {\r\n          target.focus();\r\n          target.click();\r\n          focused = true;\r\n          console.log('✅ Focused Monaco element:', selector);\r\n          break;\r\n        }\r\n      }\r\n      \r\n      if (!focused) {\r\n        monacoContainer.click();\r\n        console.log('⚠️ Clicked container as fallback');\r\n      }\r\n    }, 100);\r\n    \r\n    this.speak(\"Editor de cod activat. Scrie normal. Apasă Escape pentru a ieși.\", 'high');\r\n    \r\n    document.body.classList.add('editing-monaco');\r\n    \r\n    document.dispatchEvent(new CustomEvent('monacoEditModeChanged', {\r\n      detail: { isActive: true }\r\n    }));\r\n    \r\n    console.log('🟢 Monaco Editor fully activated');\r\n  }\r\n  \r\n  exitMonacoEditor() {\r\n    console.log('🔴 Exiting Monaco Editor...');\r\n    \r\n    this.monacoActive = false;\r\n    this.isInMonacoEditor = false;\r\n    this.isEditMode = false;\r\n    \r\n    // Blur toate elementele Monaco posibile\r\n    const monacoElements = document.querySelectorAll('.monaco-editor textarea, .inputarea, [role=\"textbox\"]');\r\n    monacoElements.forEach(el => el.blur());\r\n    \r\n    // Blur și elementul activ curent\r\n    if (document.activeElement) {\r\n      document.activeElement.blur();\r\n    }\r\n    \r\n    document.body.classList.remove('editing-monaco');\r\n    \r\n    this.speak(\"Am ieșit din editorul de cod. Navigare reactivată.\", 'high');\r\n    \r\n    // Re-focusăm containerul pentru navigare\r\n    if (this.currentEditElement) {\r\n      const container = this.currentEditElement.closest('.monaco-editor') || \r\n                       this.currentEditElement.closest('.editor-wrapper') ||\r\n                       this.currentEditElement;\r\n      \r\n      setTimeout(() => {\r\n        this.setFocus(container);\r\n      }, 100);\r\n      \r\n      this.currentEditElement = null;\r\n    }\r\n    \r\n    document.dispatchEvent(new CustomEvent('monacoEditModeChanged', {\r\n      detail: { isActive: false }\r\n    }));\r\n    \r\n    console.log('✅ Monaco Editor deactivated');\r\n  }\r\n\r\n  enterEditMode(element) {\r\n    // Pentru input-uri normale (non-Monaco)\r\n    this.isEditMode = true;\r\n    this.currentEditElement = element;\r\n    \r\n    element.focus();\r\n    element.classList.add('accessibility-edit-mode');\r\n    \r\n    // FIXAT: Pentru câmpurile de parolă, nu citim caracterele\r\n    const inputType = element.type;\r\n    let announcement = 'Mod editare activat. ';\r\n    \r\n    if (inputType === 'password') {\r\n      announcement += 'Câmp parolă. Caracterele nu vor fi citite pentru securitate. ';\r\n    } else {\r\n      announcement += this.getEditModeInstructions(element);\r\n    }\r\n    \r\n    this.speak(announcement, 'high');\r\n    \r\n    document.body.classList.add('editing');\r\n    \r\n    document.dispatchEvent(new CustomEvent('editModeChanged', {\r\n      detail: { isEditMode: true, element: element }\r\n    }));\r\n  }\r\n  \r\n  exitEditMode() {\r\n    if (!this.isEditMode) return;\r\n    \r\n    this.isEditMode = false;\r\n    \r\n    if (this.currentEditElement) {\r\n      this.currentEditElement.blur();\r\n      this.currentEditElement.classList.remove('accessibility-edit-mode');\r\n      document.body.classList.remove('editing');\r\n      \r\n      this.speak(\"Mod editare dezactivat. Navigare reactivată\", 'high');\r\n      \r\n      // Re-focusăm elementul pentru navigare\r\n      this.setFocus(this.currentEditElement);\r\n      \r\n      this.currentEditElement = null;\r\n    }\r\n    \r\n    document.dispatchEvent(new CustomEvent('editModeChanged', {\r\n      detail: { isEditMode: false }\r\n    }));\r\n  }\r\n\r\n  getEditModeInstructions(element) {\r\n    const tagName = element.tagName.toLowerCase();\r\n    let instructions = \"\";\r\n    \r\n    switch (tagName) {\r\n      case 'input':\r\n        const inputType = element.type;\r\n        if (inputType === 'text' || inputType === 'email') {\r\n          instructions = \"Tastează textul dorit. \";\r\n        } else if (inputType === 'password') {\r\n          instructions = \"Tastează parola. Caracterele nu vor fi citite pentru securitate. \";\r\n        }\r\n        break;\r\n        \r\n      case 'textarea':\r\n        instructions = \"Tastează textul. Folosește Enter pentru linie nouă. \";\r\n        break;\r\n        \r\n      case 'select':\r\n        instructions = \"Folosește săgețile sus/jos pentru a selecta o opțiune. \";\r\n        break;\r\n        \r\n      default:\r\n        instructions = \"Element în modul editare. \";\r\n        break;\r\n    }\r\n    \r\n    if (element.type !== 'password') {\r\n      instructions += \"Alt+Q pentru a citi linia curentă. \";\r\n      instructions += \"Alt+W pentru a citi cuvântul curent. \";\r\n    }\r\n    instructions += \"Escape pentru a ieși din modul editare.\";\r\n    \r\n    return instructions;\r\n  }\r\n\r\n  toggleAccessibilityMode() {\r\n    this.isAccessibilityMode = !this.isAccessibilityMode;\r\n    \r\n    if (this.isAccessibilityMode) {\r\n      // ÎMBUNĂTĂȚIRE: Anunț clar la activare\r\n      this.speak(\"Modul pentru nevăzători a fost activat cu succes! Bine ai venit în JavaVerse!\", 'high');\r\n      this.addAccessibilityStyles();\r\n      this.updateFocusableElements();\r\n      \r\n      setTimeout(() => {\r\n        this.readWelcomeMessage();\r\n      }, 2000);\r\n    } else {\r\n      this.speak(\"Modul pentru nevăzători dezactivat.\");\r\n      this.removeAccessibilityStyles();\r\n      this.stopReading();\r\n      \r\n      if (this.isEditMode) {\r\n        this.exitEditMode();\r\n      }\r\n      \r\n      if (this.isInMonacoEditor || this.monacoActive) {\r\n        this.exitMonacoEditor();\r\n      }\r\n    }\r\n    \r\n    document.dispatchEvent(new CustomEvent('accessibilityModeChanged', {\r\n      detail: { isActive: this.isAccessibilityMode }\r\n    }));\r\n  }\r\n\r\n  readWelcomeMessage() {\r\n    const welcomeText = `\r\n      Bine ai venit în modul pentru nevăzători JavaVerse!\r\n      \r\n      Navigare principală:\r\n      - Tab pentru următorul element\r\n      - Shift + Tab pentru elementul anterior\r\n      - Enter pentru a activa elementul selectat\r\n      - Spațiu pentru pauză sau continuare citire\r\n      - Escape pentru a opri citirea\r\n      \r\n      Navigare rapidă:\r\n      - F1 pentru meniul de ajutor\r\n      - F2 pentru autentificare\r\n      - F3 pentru înregistrare\r\n      \r\n      Navigare în site cu Alt:\r\n      - Alt + C pentru cursuri\r\n      - Alt + P pentru playground\r\n      - Alt + R pentru profil\r\n      - Alt + H pentru pagina principală\r\n      - Alt + B pentru înapoi la pagina anterioară\r\n      \r\n      Navigare prin elemente cu Ctrl:\r\n      - Ctrl + B pentru următorul buton\r\n      - Ctrl + L pentru următorul link\r\n      - Ctrl + I pentru următorul câmp de input\r\n      - Ctrl + T pentru următorul titlu\r\n      \r\n      În editorul de cod:\r\n      - Enter pentru a intra în editor\r\n      - Scrie normal ca în orice editor\r\n      - Escape pentru a ieși din editor și a reveni la navigare\r\n      \r\n      Alte comenzi utile:\r\n      - Alt + M pentru citirea paginii curente\r\n      - Alt + N pentru informații de navigare\r\n      - Alt + S pentru ajustarea vitezei de citire\r\n      - Alt + L pentru lista tuturor elementelor\r\n      \r\n      În quiz folosește Alt + 1, 2, 3 sau 4 pentru variante.\r\n      În editor folosește Alt + E pentru execuție și Alt + F pentru feedback.\r\n    `;\r\n    \r\n    this.speak(welcomeText, 'high');\r\n  }\r\n\r\n  handleAccessibilityShortcuts(e) {\r\n    if (this.isEditMode || this.isInMonacoEditor || this.monacoActive) return;\r\n    \r\n    const key = this.getShortcutKey(e);\r\n    const handler = this.shortcuts.get(key);\r\n    \r\n    if (handler) {\r\n      e.preventDefault();\r\n      handler();\r\n    }\r\n  }\r\n\r\n  getShortcutKey(e) {\r\n    const parts = [];\r\n    \r\n    if (e.ctrlKey) parts.push('ctrl');\r\n    if (e.altKey) parts.push('alt');\r\n    if (e.shiftKey) parts.push('Shift');\r\n    \r\n    let key = e.key;\r\n    if (key === ' ') key = ' ';\r\n    if (key.length === 1) key = key.toLowerCase();\r\n    \r\n    parts.push(key);\r\n    \r\n    return parts.join('+');\r\n  }\r\n\r\n  // ÎMBUNĂTĂȚIRE: updateFocusableElements pentru a exclude elemente redundante\r\n  updateFocusableElements() {\r\n    const selectors = [\r\n      'a[href]:not([disabled]):not(.footer-link)', // Excludem linkurile din footer\r\n      'button:not([disabled])',\r\n      'input:not([disabled]):not([type=\"hidden\"])',\r\n      'select:not([disabled])',\r\n      'textarea:not([disabled])',\r\n      '[tabindex]:not([tabindex=\"-1\"])',\r\n      '.course-card',\r\n      '.question-container li',\r\n      '.feature-card',\r\n      '.example-card',\r\n      'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\r\n      '[role=\"button\"]:not([disabled])',\r\n      '[role=\"link\"]',\r\n      '[role=\"navigation\"]',\r\n      '[role=\"main\"]',\r\n      '.monaco-editor',\r\n      '.editor-wrapper',\r\n      '#code-editor',\r\n      '.tabButton', // Pentru tab-urile din profil\r\n      '.statCard', // Pentru cardurile de statistici\r\n      '.continueButton', // Pentru butonul continua din cursuri\r\n      '.achievementCard' // Pentru cardurile de realizări\r\n    ];\r\n    \r\n    this.focusableElements = Array.from(document.querySelectorAll(selectors.join(', ')))\r\n      .filter(el => {\r\n        const rect = el.getBoundingClientRect();\r\n        // Excludem elementele care nu sunt vizibile\r\n        if (rect.width === 0 || rect.height === 0 || el.offsetParent === null) {\r\n          return false;\r\n        }\r\n        \r\n        // Excludem elementele din footer\r\n        if (el.closest('.jv-footer')) {\r\n          return false;\r\n        }\r\n        \r\n        // FIXAT: Excludem chenarul alb de pe pagina cu cursuri\r\n        if (el.classList.contains('accessibility-navigation-info')) {\r\n          return false;\r\n        }\r\n        \r\n        // Pentru pagina de profil - optimizare navigare\r\n        if (window.location.pathname === '/profile') {\r\n          // Dacă suntem pe tab-ul cursuri, includem doar elementele relevante\r\n          const activeTab = document.querySelector('.activeTab')?.textContent;\r\n          if (activeTab === 'Cursurile Mele') {\r\n            // Includem doar cardurile de cursuri și butoanele lor\r\n            if (el.classList.contains('tabButton') || \r\n                el.closest('.courseCard') || \r\n                el.classList.contains('continueButton')) {\r\n              return true;\r\n            }\r\n            return false;\r\n          }\r\n          // Similar pentru alte tab-uri\r\n          if (activeTab === 'Realizări') {\r\n            if (el.classList.contains('tabButton') || \r\n                el.closest('.achievementsContainer') ||\r\n                el.classList.contains('checkAchievementsBtn')) {\r\n              return true;\r\n            }\r\n            return false;\r\n          }\r\n          if (activeTab === 'Setări') {\r\n            if (el.classList.contains('tabButton') || \r\n                el.closest('.settingsContainer')) {\r\n              return true;\r\n            }\r\n            return false;\r\n          }\r\n        }\r\n        \r\n        return true;\r\n      })\r\n      .sort((a, b) => {\r\n        const rectA = a.getBoundingClientRect();\r\n        const rectB = b.getBoundingClientRect();\r\n        \r\n        if (Math.abs(rectA.top - rectB.top) < 10) {\r\n          return rectA.left - rectB.left;\r\n        }\r\n        return rectA.top - rectB.top;\r\n      });\r\n  }\r\n\r\n  navigateNext() {\r\n    this.updateFocusableElements();\r\n    \r\n    if (this.focusableElements.length === 0) {\r\n      this.speak(\"Nu sunt elemente disponibile pentru navigare\", 'high');\r\n      return;\r\n    }\r\n    \r\n    this.currentFocusIndex = (this.currentFocusIndex + 1) % this.focusableElements.length;\r\n    this.setFocus(this.focusableElements[this.currentFocusIndex]);\r\n  }\r\n\r\n  navigatePrevious() {\r\n    this.updateFocusableElements();\r\n    \r\n    if (this.focusableElements.length === 0) {\r\n      this.speak(\"Nu sunt elemente disponibile pentru navigare\", 'high');\r\n      return;\r\n    }\r\n    \r\n    this.currentFocusIndex = this.currentFocusIndex === 0 \r\n      ? this.focusableElements.length - 1 \r\n      : this.currentFocusIndex - 1;\r\n      \r\n    this.setFocus(this.focusableElements[this.currentFocusIndex]);\r\n  }\r\n\r\n  setFocus(element) {\r\n    if (!element) return;\r\n    \r\n    document.querySelectorAll('.accessibility-focus').forEach(el => {\r\n      el.classList.remove('accessibility-focus');\r\n    });\r\n    \r\n    this.focusedElement = element;\r\n    element.classList.add('accessibility-focus');\r\n    \r\n    element.scrollIntoView({ \r\n      behavior: 'smooth', \r\n      block: 'center',\r\n      inline: 'nearest'\r\n    });\r\n    \r\n    if (['INPUT', 'TEXTAREA', 'SELECT'].includes(element.tagName) && !this.isEditMode) {\r\n      // Nu dăm focus automat\r\n    }\r\n    \r\n    this.readElementInfo(element);\r\n  }\r\n\r\n  // ÎMBUNĂTĂȚIRE: readElementInfo pentru a evita citirea redundantă\r\n  readElementInfo(element) {\r\n    let description = '';\r\n    const tagName = element.tagName.toLowerCase();\r\n    const ariaLabel = element.getAttribute('aria-label');\r\n    const text = element.textContent?.trim();\r\n    \r\n    // Verificăm mai întâi dacă e Monaco Editor\r\n    if (this.isMonacoRelated(element)) {\r\n      const codeContent = this.getMonacoContent(element);\r\n      if (codeContent) {\r\n        description = `Editor de cod. ${codeContent.split('\\n').length} linii de cod. Apasă Enter pentru a edita.`;\r\n      } else {\r\n        description = 'Editor de cod gol. Apasă Enter pentru a începe să scrii cod.';\r\n      }\r\n      this.speak(description, 'high');\r\n      return;\r\n    }\r\n    \r\n    if (ariaLabel) {\r\n      description = ariaLabel;\r\n    } else {\r\n      switch (tagName) {\r\n        case 'button':\r\n          // Pentru butonul \"Continuă\" din profil\r\n          if (element.classList.contains('continueButton')) {\r\n            description = `Buton Continuă cursul`;\r\n          } else {\r\n            description = `Buton: ${text || 'Fără text'}`;\r\n          }\r\n          break;\r\n          \r\n        case 'a':\r\n          description = `Link: ${text || 'Fără text'}`;\r\n          break;\r\n          \r\n        case 'input':\r\n          const inputType = element.type;\r\n          const inputLabel = document.querySelector(`label[for=\"${element.id}\"]`)?.textContent;\r\n          const inputValue = element.value;\r\n          \r\n          if (inputType === 'text' || inputType === 'email' || inputType === 'password') {\r\n            description = `Câmp ${inputType}: ${inputLabel || element.placeholder || 'Fără etichetă'}`;\r\n            if (inputValue && inputType !== 'password') {\r\n              description += `. Valoare curentă: ${inputValue}`;\r\n            } else if (inputValue && inputType === 'password') {\r\n              description += `. Parolă introdusă`;\r\n            }\r\n          } else if (inputType === 'radio' || inputType === 'checkbox') {\r\n            description = `${inputType === 'radio' ? 'Opțiune' : 'Bifă'}: ${inputLabel || text}. ${element.checked ? 'Selectat' : 'Neselectat'}`;\r\n          }\r\n          break;\r\n          \r\n        case 'select':\r\n          const selectLabel = document.querySelector(`label[for=\"${element.id}\"]`)?.textContent;\r\n          const selectedOption = element.options[element.selectedIndex]?.text;\r\n          description = `Listă derulantă: ${selectLabel || 'Fără etichetă'}. Selectat: ${selectedOption || 'Nimic'}`;\r\n          break;\r\n          \r\n        case 'textarea':\r\n          const textareaLabel = document.querySelector(`label[for=\"${element.id}\"]`)?.textContent;\r\n          description = `Zonă de text: ${textareaLabel || element.placeholder || 'Fără etichetă'}`;\r\n          if (element.value) {\r\n            description += `. ${element.value.length} caractere introduse`;\r\n          }\r\n          break;\r\n          \r\n        case 'h1':\r\n        case 'h2':\r\n        case 'h3':\r\n        case 'h4':\r\n        case 'h5':\r\n        case 'h6':\r\n          // ÎMBUNĂTĂȚIRE: Nu citim titlurile ca elemente separate dacă fac parte dintr-un card\r\n          if (element.closest('.course-card') || element.closest('.statCard') || \r\n              element.closest('.achievementCard') || element.closest('.settingSection')) {\r\n            return; // Nu citim titlurile din interiorul cardurilor\r\n          }\r\n          const level = tagName.charAt(1);\r\n          description = `Titlu nivel ${level}: ${text}`;\r\n          break;\r\n          \r\n        default:\r\n          if (element.classList.contains('course-card')) {\r\n            const title = element.querySelector('.course-title, h2, h3')?.textContent;\r\n            const desc = element.querySelector('.course-description, p')?.textContent;\r\n            description = `Curs: ${title}. ${desc || ''}`;\r\n          } else if (element.classList.contains('statCard')) {\r\n            const value = element.querySelector('.statValue')?.textContent;\r\n            const label = element.querySelector('.statLabel')?.textContent;\r\n            description = `Statistică: ${value} ${label}`;\r\n          } else if (element.classList.contains('feature-card')) {\r\n            const title = element.querySelector('h3')?.textContent;\r\n            const desc = element.querySelector('p')?.textContent;\r\n            description = `Caracteristică: ${title}. ${desc}`;\r\n          } else if (element.classList.contains('example-card')) {\r\n            const title = element.querySelector('.card-title')?.textContent || text;\r\n            description = `Exemplu de cod: ${title}`;\r\n          } else if (element.classList.contains('tabButton')) {\r\n            description = `Tab: ${text}`;\r\n          } else if (element.classList.contains('achievementCard')) {\r\n            const name = element.querySelector('h3')?.textContent;\r\n            const desc = element.querySelector('p')?.textContent;\r\n            const isUnlocked = !element.classList.contains('lockedAchievement');\r\n            description = `Realizare ${isUnlocked ? 'deblocată' : 'blocată'}: ${name}. ${desc}`;\r\n          } else {\r\n            description = text || `Element ${tagName}`;\r\n          }\r\n          break;\r\n      }\r\n    }\r\n    \r\n    if (['button', 'a'].includes(tagName) || element.getAttribute('role') === 'button') {\r\n      description += \". Apasă Enter pentru a activa\";\r\n    } else if (['input', 'textarea', 'select'].includes(tagName)) {\r\n      description += \". Apasă Enter pentru a edita\";\r\n    }\r\n    \r\n    this.speak(description, 'high');\r\n  }\r\n\r\n  navigateToSection(sectionName) {\r\n    let selector;\r\n    let announcement;\r\n    \r\n    switch (sectionName) {\r\n      case 'header':\r\n        selector = 'header, [role=\"banner\"], .jv-header';\r\n        announcement = \"Navighez la header\";\r\n        break;\r\n      case 'main':\r\n        selector = 'main, [role=\"main\"], .body-content';\r\n        announcement = \"Navighez la conținutul principal\";\r\n        break;\r\n      default:\r\n        this.speak(\"Secțiune necunoscută\", 'high');\r\n        return;\r\n    }\r\n    \r\n    const section = document.querySelector(selector);\r\n    if (section) {\r\n      this.speak(announcement, 'high');\r\n      \r\n      const firstFocusable = section.querySelector(\r\n        'a, button, input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\r\n      );\r\n      \r\n      if (firstFocusable) {\r\n        const index = this.focusableElements.indexOf(firstFocusable);\r\n        if (index !== -1) {\r\n          this.currentFocusIndex = index;\r\n          this.setFocus(firstFocusable);\r\n        }\r\n      } else {\r\n        section.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n        this.speak(\"Secțiune fără elemente interactive\", 'normal');\r\n      }\r\n    } else {\r\n      this.speak(\"Secțiunea nu a fost găsită\", 'high');\r\n    }\r\n  }\r\n\r\n  nextButton() {\r\n    this.navigateToNextOfType('button, [role=\"button\"]', 'buton');\r\n  }\r\n\r\n  nextLink() {\r\n    this.navigateToNextOfType('a[href]', 'link');\r\n  }\r\n\r\n  nextInput() {\r\n    this.navigateToNextOfType('input, textarea, select', 'câmp de input');\r\n  }\r\n\r\n  nextHeading() {\r\n    this.navigateToNextOfType('h1, h2, h3, h4, h5, h6', 'titlu');\r\n  }\r\n\r\n  navigateToNextOfType(selector, typeName) {\r\n    const elements = Array.from(document.querySelectorAll(selector))\r\n      .filter(el => el.offsetParent !== null);\r\n    \r\n    if (elements.length === 0) {\r\n      this.speak(`Nu există ${typeName} pe această pagină`, 'high');\r\n      return;\r\n    }\r\n    \r\n    let nextIndex = -1;\r\n    \r\n    if (this.focusedElement) {\r\n      const currentTypeIndex = elements.indexOf(this.focusedElement);\r\n      if (currentTypeIndex !== -1) {\r\n        nextIndex = (currentTypeIndex + 1) % elements.length;\r\n      } else {\r\n        const currentRect = this.focusedElement.getBoundingClientRect();\r\n        for (let i = 0; i < elements.length; i++) {\r\n          const rect = elements[i].getBoundingClientRect();\r\n          if (rect.top > currentRect.top || \r\n              (Math.abs(rect.top - currentRect.top) < 10 && rect.left > currentRect.left)) {\r\n            nextIndex = i;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (nextIndex === -1) {\r\n      nextIndex = 0;\r\n    }\r\n    \r\n    const targetElement = elements[nextIndex];\r\n    const globalIndex = this.focusableElements.indexOf(targetElement);\r\n    \r\n    if (globalIndex !== -1) {\r\n      this.currentFocusIndex = globalIndex;\r\n      this.setFocus(targetElement);\r\n    }\r\n  }\r\n\r\n  adjustSpeed() {\r\n    const speeds = [0.7, 0.85, 1.0, 1.15, 1.3];\r\n    const currentIndex = speeds.indexOf(this.readingSpeed);\r\n    const nextIndex = (currentIndex + 1) % speeds.length;\r\n    \r\n    this.readingSpeed = speeds[nextIndex];\r\n    this.speak(`Viteză de citire: ${Math.round(this.readingSpeed * 100)}%`, 'high');\r\n  }\r\n\r\n  speak(text, priority = 'normal') {\r\n    if (!text || text.trim() === '') return;\r\n\r\n    if (priority === 'high') {\r\n      this.stopReading();\r\n    }\r\n\r\n    const utterance = new SpeechSynthesisUtterance(text);\r\n    if (this.voice) {\r\n      utterance.voice = this.voice;\r\n    }\r\n    \r\n    utterance.rate = this.readingSpeed;\r\n    utterance.pitch = 1.0;\r\n    utterance.volume = 1.0;\r\n\r\n    utterance.onstart = () => {\r\n      this.isReading = true;\r\n      this.currentUtterance = utterance;\r\n      \r\n      document.dispatchEvent(new CustomEvent('speechStatusChanged', {\r\n        detail: { isSpeaking: true }\r\n      }));\r\n    };\r\n\r\n    utterance.onend = () => {\r\n      this.isReading = false;\r\n      this.currentUtterance = null;\r\n      this.processQueue();\r\n      \r\n      document.dispatchEvent(new CustomEvent('speechStatusChanged', {\r\n        detail: { isSpeaking: false }\r\n      }));\r\n    };\r\n\r\n    utterance.onerror = (e) => {\r\n      console.error('Speech synthesis error:', e);\r\n      this.isReading = false;\r\n      this.currentUtterance = null;\r\n    };\r\n\r\n    if (this.isReading && priority !== 'high') {\r\n      this.readingQueue.push(utterance);\r\n    } else {\r\n      this.speechSynthesis.speak(utterance);\r\n    }\r\n  }\r\n\r\n  // METODĂ ÎMBUNĂTĂȚITĂ: navigare cu persistența modului de accesibilitate\r\n  navigateWithAccessibilityPersistence(destination, url) {\r\n    // Salvăm starea modului de accesibilitate\r\n    sessionStorage.setItem('accessibilityModeActive', this.isAccessibilityMode.toString());\r\n    \r\n    this.navigationHistory.push(window.location.href);\r\n    this.speak(`Navighez la ${destination}`, 'high');\r\n    \r\n    // Navigăm la URL\r\n    window.location.href = url;\r\n  }\r\n\r\n  // FIXAT: navigateBack pentru a merge la pagina anterioară din browser\r\n  navigateBack() {\r\n    this.speak(\"Navighez înapoi\", 'high');\r\n    \r\n    // Persistăm modul de accesibilitate\r\n    sessionStorage.setItem('accessibilityModeActive', this.isAccessibilityMode.toString());\r\n    \r\n    // Folosim history.back() pentru a merge la pagina anterioară din browser\r\n    window.history.back();\r\n  }\r\n\r\n  listAllElements() {\r\n    this.updateFocusableElements();\r\n    \r\n    const totalElements = this.focusableElements.length;\r\n    const currentPosition = this.currentFocusIndex + 1;\r\n    \r\n    let summary = `Pagina conține ${totalElements} elemente interactive. `;\r\n    summary += `Ești la elementul ${currentPosition} din ${totalElements}. `;\r\n    \r\n    const counts = {\r\n      buttons: document.querySelectorAll('button, [role=\"button\"]').length,\r\n      links: document.querySelectorAll('a[href]').length,\r\n      inputs: document.querySelectorAll('input, textarea, select').length,\r\n      headings: document.querySelectorAll('h1, h2, h3, h4, h5, h6').length\r\n    };\r\n    \r\n    summary += `Găsit: ${counts.buttons} butoane, ${counts.links} linkuri, `;\r\n    summary += `${counts.inputs} câmpuri de input, ${counts.headings} titluri.`;\r\n    \r\n    this.speak(summary, 'high');\r\n  }\r\n\r\n  // METODE ÎMBUNĂTĂȚITE pentru navigare cu persistența accesibilității\r\n  navigateToCourses() {\r\n    this.navigateWithAccessibilityPersistence('cursuri', '/courses');\r\n  }\r\n\r\n  navigateToPlayground() {\r\n    this.navigateWithAccessibilityPersistence('playground', '/playground');\r\n  }\r\n\r\n  navigateToProfile() {\r\n    this.navigateWithAccessibilityPersistence('profil', '/profile');\r\n  }\r\n\r\n  goHome() {\r\n    this.navigateWithAccessibilityPersistence('pagina principală', '/');\r\n  }\r\n\r\n  selectQuizOption(index) {\r\n    const options = document.querySelectorAll('.question-container li');\r\n    if (options[index]) {\r\n      options[index].click();\r\n      this.speak(`Selectat răspunsul ${index + 1}`, 'high');\r\n    } else {\r\n      this.speak(`Nu există răspunsul ${index + 1}`, 'high');\r\n    }\r\n  }\r\n\r\n  executeCode() {\r\n    const runButton = document.querySelector('.editor-actions button[aria-label*=\"Execută\"]');\r\n    if (runButton) {\r\n      runButton.click();\r\n      this.speak(\"Execut codul\", 'high');\r\n    } else {\r\n      this.speak(\"Butonul de execuție nu a fost găsit\", 'high');\r\n    }\r\n  }\r\n\r\n  getFeedback() {\r\n    const feedbackButton = document.querySelector('.editor-actions button[aria-label*=\"feedback\"]');\r\n    if (feedbackButton) {\r\n      feedbackButton.click();\r\n      this.speak(\"Solicit feedback AI\", 'high');\r\n    } else {\r\n      this.speak(\"Butonul de feedback nu a fost găsit\", 'high');\r\n    }\r\n  }\r\n\r\n  readNavigationInfo() {\r\n    const currentUrl = window.location.pathname;\r\n    const totalElements = this.focusableElements.length;\r\n    const position = this.currentFocusIndex + 1;\r\n    \r\n    let info = `Ești pe ${this.getPageName(currentUrl)}. `;\r\n    info += `Elementul curent: ${position} din ${totalElements}. `;\r\n    info += `Folosește Tab pentru navigare sau apasă F1 pentru ajutor.`;\r\n    \r\n    this.speak(info, 'high');\r\n  }\r\n\r\n  getPageName(url) {\r\n    if (url === '/' || url === '') return 'pagina principală';\r\n    if (url.includes('/courses')) return 'pagina de cursuri';\r\n    if (url.includes('/playground')) return 'playground-ul de cod';\r\n    if (url.includes('/profile')) return 'pagina de profil';\r\n    if (url.includes('/login')) return 'pagina de autentificare';\r\n    if (url.includes('/register')) return 'pagina de înregistrare';\r\n    if (url.includes('/quiz')) return 'pagina de test';\r\n    return 'pagina curentă';\r\n  }\r\n\r\n  readHelp() {\r\n    const currentPage = this.getPageName(window.location.pathname);\r\n    \r\n    const helpText = `\r\n      Ajutor pentru ${currentPage}.\r\n      \r\n      Comenzi esențiale:\r\n      - Tab și Shift Tab pentru navigare înainte și înapoi\r\n      - Enter pentru a activa elementul selectat\r\n      - Spațiu pentru pauză sau continuare citire\r\n      - Escape pentru oprire citire\r\n      \r\n      Navigare rapidă cu taste funcționale:\r\n      - F1 pentru acest ajutor\r\n      - F2 pentru autentificare\r\n      - F3 pentru înregistrare\r\n      \r\n      Navigare în site cu Alt:\r\n      - Alt C pentru cursuri\r\n      - Alt P pentru playground\r\n      - Alt R pentru profil\r\n      - Alt H pentru acasă\r\n      - Alt B pentru înapoi la pagina anterioară\r\n      \r\n      Navigare prin tipuri cu Ctrl:\r\n      - Ctrl B pentru butoane\r\n      - Ctrl L pentru linkuri\r\n      - Ctrl I pentru câmpuri input\r\n      - Ctrl T pentru titluri\r\n      \r\n      În modul editare:\r\n      - Alt Q pentru a citi linia curentă\r\n      - Alt W pentru a citi cuvântul curent\r\n      - Alt D pentru a comuta citirea live\r\n      - Escape pentru a ieși din editare\r\n      \r\n      Comenzi speciale:\r\n      - Alt M pentru citirea paginii\r\n      - Alt N pentru informații navigare\r\n      - Alt S pentru viteză citire\r\n      - Alt L pentru lista elementelor\r\n      \r\n      ${this.getPageSpecificHelp(currentPage)}\r\n    `;\r\n    \r\n    this.speak(helpText, 'high');\r\n  }\r\n\r\n  getPageSpecificHelp(pageName) {\r\n    switch (pageName) {\r\n      case 'pagina de cursuri':\r\n        return 'În această pagină: Navighează prin cursuri cu Tab. Apasă Enter pentru a selecta un curs.';\r\n        \r\n      case 'playground-ul de cod':\r\n        return 'În editor: Alt E pentru execuție, Alt F pentru feedback AI. În modul editare, săgețile sus/jos citesc linia curentă.';\r\n        \r\n      case 'pagina de test':\r\n        return 'În test: Alt 1-4 pentru răspunsuri. Enter pentru verificare sau următoarea întrebare.';\r\n        \r\n      case 'pagina de profil':\r\n        return 'În profil: Navighează prin secțiuni cu Tab. Enter pentru a modifica setările.';\r\n        \r\n      case 'pagina de autentificare':\r\n      case 'pagina de înregistrare':\r\n        return 'Completează câmpurile cu Tab și Enter. În modul editare, tastează normal și folosește Escape când termini.';\r\n        \r\n      default:\r\n        return 'Folosește Tab pentru navigare și F1 pentru ajutor.';\r\n    }\r\n  }\r\n\r\n  stopReading() {\r\n    if (this.speechSynthesis.speaking) {\r\n      this.speechSynthesis.cancel();\r\n    }\r\n    \r\n    this.isReading = false;\r\n    this.currentUtterance = null;\r\n    this.readingQueue = [];\r\n    \r\n    document.dispatchEvent(new CustomEvent('speechStatusChanged', {\r\n      detail: { isSpeaking: false }\r\n    }));\r\n  }\r\n\r\n  processQueue() {\r\n    if (this.readingQueue.length > 0 && !this.isReading) {\r\n      const nextUtterance = this.readingQueue.shift();\r\n      this.speechSynthesis.speak(nextUtterance);\r\n    }\r\n  }\r\n\r\n  toggleReading() {\r\n    if (this.isReading && this.currentUtterance) {\r\n      if (this.speechSynthesis.paused) {\r\n        this.speechSynthesis.resume();\r\n        this.speak(\"Reluare citire\", 'normal');\r\n      } else {\r\n        this.speechSynthesis.pause();\r\n        this.speak(\"Pauză citire\", 'normal');\r\n      }\r\n    } else {\r\n      this.readCurrentPage();\r\n    }\r\n  }\r\n\r\n  readCurrentPage() {\r\n    const pageContent = this.extractPageContent();\r\n    if (pageContent) {\r\n      this.speak(pageContent, 'high');\r\n    } else {\r\n      this.speak(\"Nu există conținut de citit pe această pagină\", 'high');\r\n    }\r\n  }\r\n\r\n  extractPageContent() {\r\n    let content = '';\r\n    \r\n    const title = document.querySelector('h1');\r\n    if (title) {\r\n      content += `Titlu: ${title.textContent.trim()}. `;\r\n    }\r\n    \r\n    const description = document.querySelector('.page-description, .course-detail-description, .code-playground-description');\r\n    if (description) {\r\n      content += `${description.textContent.trim()}. `;\r\n    }\r\n    \r\n    const mainContent = document.querySelector('main, .body-content, .course-detail-content');\r\n    if (mainContent) {\r\n      const paragraphs = mainContent.querySelectorAll('p, h2, h3, h4, li');\r\n      paragraphs.forEach(p => {\r\n        const text = p.textContent.trim();\r\n        if (text && text.length > 0) {\r\n          content += `${text}. `;\r\n        }\r\n      });\r\n    }\r\n    \r\n    const lessons = document.querySelectorAll('.course-preview-item, .lesson-title');\r\n    if (lessons.length > 0) {\r\n      content += 'Lecții disponibile: ';\r\n      lessons.forEach((lesson, index) => {\r\n        content += `${index + 1}. ${lesson.textContent.trim()}. `;\r\n      });\r\n    }\r\n    \r\n    const currentQuestion = document.querySelector('.question-container h3');\r\n    if (currentQuestion) {\r\n      content += `Întrebare: ${currentQuestion.textContent.trim()}. `;\r\n      \r\n      const options = document.querySelectorAll('.question-container li label');\r\n      if (options.length > 0) {\r\n        content += 'Opțiuni: ';\r\n        options.forEach((option, index) => {\r\n          content += `${index + 1}. ${option.textContent.trim()}. `;\r\n        });\r\n      }\r\n    }\r\n    \r\n    return content.trim();\r\n  }\r\n\r\n  announce(message, priority = 'normal') {\r\n    this.speak(message, priority);\r\n  }\r\n\r\n  get isSpeaking() {\r\n    return this.isReading || this.speechSynthesis.speaking;\r\n  }\r\n\r\n  get isActive() {\r\n    return this.isAccessibilityMode;\r\n  }\r\n\r\n  readQuizQuestion(question, options) {\r\n    let text = `Întrebare: ${question}. `;\r\n    if (options && options.length > 0) {\r\n      text += 'Variantele de răspuns sunt: ';\r\n      options.forEach((option, index) => {\r\n        text += `${index + 1}: ${option}. `;\r\n      });\r\n    }\r\n    this.speak(text, 'high');\r\n  }\r\n\r\n  announceQuizResult(score, totalQuestions) {\r\n    const percentage = Math.round((score / totalQuestions) * 100);\r\n    const text = `Test finalizat! Ai răspuns corect la ${score} din ${totalQuestions} întrebări. ` +\r\n                 `Scorul tău este ${percentage}%. ` +\r\n                 (percentage >= 80 ? 'Felicitări! Rezultat excelent!' : \r\n                  percentage >= 60 ? 'Rezultat bun! Continuă să înveți.' : \r\n                  'Nu te descuraja! Încearcă din nou pentru un rezultat mai bun.');\r\n    this.speak(text, 'high');\r\n  }\r\n\r\n  readCodeLine(lineNumber, content) {\r\n    if (content) {\r\n      this.speak(`Linia ${lineNumber}: ${content}`, 'normal');\r\n    } else {\r\n      this.speak(`Linia ${lineNumber}: linie goală`, 'normal');\r\n    }\r\n  }\r\n\r\n  announceCodeChange(changeType, position) {\r\n    if (changeType === 'insert') {\r\n      this.speak(\"Text adăugat\", 'normal');\r\n    } else if (changeType === 'delete') {\r\n      this.speak(\"Text șters\", 'normal');\r\n    }\r\n  }\r\n\r\n  // Obține conținutul Monaco editor-ului\r\n  getMonacoContent(element) {\r\n    try {\r\n      if (window.monaco && window.monaco.editor) {\r\n        const editors = window.monaco.editor.getEditors();\r\n        const monacoContainer = element.closest('.monaco-editor') || element;\r\n        const editor = editors.find(e => monacoContainer.contains(e.getDomNode()));\r\n        if (editor) {\r\n          return editor.getValue();\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.error('Error getting Monaco content:', e);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  addAccessibilityStyles() {\r\n    const style = document.createElement('style');\r\n    style.id = 'accessibility-styles';\r\n    style.textContent = `\r\n      /* Focus indicator pentru elementul curent */\r\n      .accessibility-focus {\r\n        outline: 3px solid #ffff00 !important;\r\n        outline-offset: 2px !important;\r\n        background-color: rgba(255, 255, 0, 0.1) !important;\r\n      }\r\n\r\n      /* Linkuri mai vizibile */\r\n      body.accessibility-mode a {\r\n        color: #00ffff !important;\r\n        text-decoration: underline !important;\r\n        font-weight: bold !important;\r\n      }\r\n      \r\n      /* Inputuri mai clare */\r\n      body.accessibility-mode input,\r\n      body.accessibility-mode textarea,\r\n      body.accessibility-mode select {\r\n        background: #111111 !important;\r\n        color: #ffffff !important;\r\n        border: 2px solid #ffffff !important;\r\n        padding: 10px !important;\r\n        font-size: 18px !important;\r\n      }\r\n      \r\n      body.accessibility-mode input:focus,\r\n      body.accessibility-mode textarea:focus,\r\n      body.accessibility-mode select:focus {\r\n        border-color: #ffff00 !important;\r\n        outline: 2px solid #ffff00 !important;\r\n      }\r\n      \r\n      /* Stil special pentru modul editare */\r\n      body.accessibility-mode input.accessibility-edit-mode,\r\n      body.accessibility-mode textarea.accessibility-edit-mode,\r\n      body.accessibility-mode select.accessibility-edit-mode {\r\n        border-color: #00ff00 !important;\r\n        outline: 2px solid #00ff00 !important;\r\n      }\r\n      \r\n      /* Simplificăm cardurile */\r\n      body.accessibility-mode .course-card,\r\n      body.accessibility-mode .feature-card,\r\n      body.accessibility-mode .example-card {\r\n        background: #111111 !important;\r\n        border: 2px solid #ffffff !important;\r\n        margin: 10px 0 !important;\r\n        padding: 20px !important;\r\n      }\r\n      \r\n      /* Eliminăm gradiente și efecte */\r\n      body.accessibility-mode [class*=\"gradient\"] {\r\n        background: #000000 !important;\r\n      }\r\n      \r\n      /* Indicator pentru elementul curent citit */\r\n      .accessibility-reading {\r\n        background-color: #333300 !important;\r\n        outline: 2px dashed #ffff00 !important;\r\n      }\r\n      \r\n      /* Simplificăm navigarea */\r\n      body.accessibility-mode nav {\r\n        background: #000000 !important;\r\n        border: 2px solid #ffffff !important;\r\n        padding: 10px !important;\r\n      }\r\n      \r\n      /* Indicator pentru modul editare activ */\r\n      body.accessibility-mode.editing::before {\r\n        content: \"MODUL EDITARE ACTIV\";\r\n        position: fixed;\r\n        top: 20px;\r\n        right: 20px;\r\n        background: #00ff00;\r\n        color: #000000;\r\n        padding: 10px 20px;\r\n        font-weight: bold;\r\n        z-index: 10001;\r\n        border-radius: 5px;\r\n      }\r\n      \r\n      /* Indicator special pentru Monaco */\r\n      body.accessibility-mode.editing-monaco::before {\r\n        content: \"EDITOR DE COD ACTIV - ESCAPE PENTRU IEȘIRE\";\r\n        background: #0066ff;\r\n      }\r\n      \r\n      /* Stiluri speciale pentru Monaco Editor în modul accesibilitate */\r\n      body.accessibility-mode .monaco-editor {\r\n        background: #111111 !important;\r\n        border: 2px solid #ffffff !important;\r\n      }\r\n      \r\n      body.accessibility-mode .monaco-editor.accessibility-focus {\r\n        border-color: #ffff00 !important;\r\n        outline: 2px solid #ffff00 !important;\r\n      }\r\n      \r\n      body.accessibility-mode .monaco-editor .view-line {\r\n        color: #ffffff !important;\r\n      }\r\n      \r\n      body.accessibility-mode .monaco-editor .cursor {\r\n        background: #ffff00 !important;\r\n        width: 3px !important;\r\n      }\r\n      \r\n      /* Prevenim interferența cu Monaco */\r\n      body.accessibility-mode.editing-monaco * {\r\n        pointer-events: auto !important;\r\n      }\r\n      \r\n      /* FIXAT: Ascundem chenarul alb de pe pagina cu cursuri */\r\n      body.accessibility-mode .accessibility-navigation-info {\r\n        display: none !important;\r\n        visibility: hidden !important;\r\n        opacity: 0 !important;\r\n        position: absolute !important;\r\n        left: -9999px !important;\r\n        width: 1px !important;\r\n        height: 1px !important;\r\n      }\r\n    `;\r\n    document.head.appendChild(style);\r\n    document.body.classList.add('accessibility-mode');\r\n    document.body.setAttribute('data-accessibility-active', 'true');\r\n  }\r\n\r\n  removeAccessibilityStyles() {\r\n    const style = document.getElementById('accessibility-styles');\r\n    if (style) style.remove();\r\n    document.body.classList.remove('accessibility-mode', 'editing', 'editing-monaco');\r\n    document.body.removeAttribute('data-accessibility-active');\r\n    \r\n    document.querySelectorAll('.accessibility-focus, .accessibility-reading, .accessibility-edit-mode').forEach(el => {\r\n      el.classList.remove('accessibility-focus', 'accessibility-reading', 'accessibility-edit-mode');\r\n    });\r\n  }\r\n\r\n  // METODĂ NOUĂ: Inițializare din sessionStorage\r\n  initializeFromStorage() {\r\n    const savedState = sessionStorage.getItem('accessibilityModeActive');\r\n    if (savedState === 'true') {\r\n      // Reactivăm modul de accesibilitate fără să anunțăm\r\n      this.isAccessibilityMode = true;\r\n      this.addAccessibilityStyles();\r\n      this.updateFocusableElements();\r\n      \r\n      // Anunțăm că modul este activ\r\n      setTimeout(() => {\r\n        this.speak(\"Modul pentru nevăzători este activ pe această pagină.\", 'high');\r\n      }, 1000);\r\n      \r\n      document.dispatchEvent(new CustomEvent('accessibilityModeChanged', {\r\n        detail: { isActive: true }\r\n      }));\r\n    }\r\n  }\r\n}\r\n\r\n// Exportăm o instanță singleton cu inițializare automată\r\nconst accessibilityManager = new AccessibilityManager();\r\n\r\n// Inițializăm din storage la încărcarea paginii\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  accessibilityManager.initializeFromStorage();\r\n});\r\n\r\nexport default accessibilityManager;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}